<!DOCTYPE html>

<html lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Average Bioequivalence</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body{background-color:#fff;margin:1em auto;max-width:700px;overflow:visible;padding-left:2em;padding-right:2em;font-size:14px;line-height:1.35;hyphens:auto;font-family:"Open Sans","Helvetica Neue",Helvetica,Arial,sans-serif}#header{text-align:center}#TOC{clear:both;margin:0 3em;padding:4px;width:auto;border:1px solid #ccc;border-radius:5px;background-color:#fbfbfb;font-size:13px;line-height:1.2em}#TOC .toctitle{font-weight:bold;font-size:15px;margin-left:5px}#TOC ul{padding-left:40px;margin:5px auto 5px -1.5em}#TOC ul ul{margin-left:-2em}#TOC li{list-style-type:none;line-height:16px}table{margin:1em auto;border-width:1px;border-color:#ddd;border-style:outset;border-collapse:collapse}table th{border-width:2px;padding:5px;border-style:inset}table td{border-width:1px;border-style:inset;line-height:18px;padding:5px 5px}table,table th,table td{border-left-style:none;border-right-style:none}table thead, table .even{background-color:#f7f7f7}p{margin:0.5em 0}sup,sub{position:relative;vertical-align:baseline;top:-0.4em}sub{top:0.4em}blockquote{background-color:#fffff6;padding:0.25em 0.75em}hr{border-style:solid;border:none;border-top:1px solid #777;margin:28px 0}dl{margin-left:0}dl dd{margin-bottom:13px;margin-left:13px}dl dt{font-weight:700}ul{margin-top:0}ul li{list-style:circle outside}ul ul{margin-bottom:0}.hl{background-color:#FFFF99}pre, code{background-color:#f7f7f7;border-radius:3px;color:#333;white-space:pre-wrap}pre{border-radius:3px;margin:5px 0 10px 0;padding:10px}pre:not([class]){background-color:#f7f7f7}code{font-size:85%;font-family:Consolas,Monaco,'Lucida Console','Courier New','Courier',monospace}p > code,li > code{padding:2px 0}figure,.caption{text-align:center}img{display:block;margin:0 auto 0 auto;background-color:#FFF;padding:2px;border-radius:5px;border:1px solid #CCC}h1{margin-top:0;padding-top:10px;padding-bottom:4px;;line-height:30px;letter-spacing:.5px;border-bottom:3px solid #f7f7f7;font-size:175%;hyphens:none}.title{margin-top:1.5em}h2{border-bottom:2px solid #f7f7f7;padding-top:10px;padding-bottom:2px;font-size:145%}h3{border-bottom:1px solid #f7f7f7;padding-top:10px;font-size:120%}h4{margin-left:8px;font-size:110%}.author{font-size:91%;margin-left:0;margin-bottom:0;font-style:normal}h5, h6{border-bottom:1px solid #ccc;font-size:105%}a{color:#0033dd;text-decoration:none}a:hover{color:#6666ff}a:visited{color:#800080}a:visited:hover{color:#BB00BB}a[href^="http:"]{color:#696969;border-bottom:1px dotted #000}a[href^="https:"]{border-bottom:1px dotted #000;color:#696969}code > .kw{color:#555;font-weight:700} code > .dt{color:#902000} code > .dv{color:#40a070} code > .bn{color:#d14} code > .fl{color:#d14} code > .ch{color:#d14} code > .st{color:#d14} code > .co{color:#888888;font-style:italic} code > .ot{color:#007020} code > .al{color:#f00;font-weight:700} code > .fu{color:#900;font-weight:700}  code > .er{color:#a61717;background-color:#e3d2d2} .top{display:inline;position:fixed;bottom:0;right:0;padding:0;font-size:108px}.top img{border:none}a.toplink:link{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAXVBMVEUAAABcgJzu7u/+///t7u9ri6XN1+G1xdKtv82nusl2k6tkhqH6+/zZ4uiGoLVvj6je4+eXrsCTq71ujKbAzdehtMScscGNprl7mK9fgp7k6Ork5+rX3uPT2+Foh6ODMk/HAAAAAXRSTlMAQObYZgAAANFJREFUKM+Fk+0aQzAMRpsW1XZlmGFf93+ZM4skxji/1OHp2zRRhImu8CH4wkWjfjnZFIjUnpY2K2FBmQlpcliRG7IVbFDNPodNctwX/pBNmWUq38p8n/wWmFrrCzB2zJWKpR55DHx+oyIthqeeuPMPUTn69KaRpAfEqQKf+kQzHb4slKdQEocHUeFbgqWdDxBQh1dzZXdumhS1B6QTmqpE0aCWmqK5Pe24LNWGjlxUGY2KylfSrrUVF1olREYXutsO+8100Ir7jXw0BsdDdDCCb/erCdkTmcUbAAAAAElFTkSuQmCC);background-repeat:no-repeat;text-decoration:none;background-color:transparent;opacity:.6;filter:alpha(opacity=60);background-position:bottom 7px right;background-size:contain}a.toplink:hover,a.toplink:active{text-decoration:none;background-color:transparent;opacity:.4;filter:alpha(opacity=40);background-position:bottom 7px right;background-size:contain}code span.co{font-style:normal}#nav{position:absolute;top:0;float:left;background-color:#084262;border:none}#nav ul{width:100%;list-style-type:none;text-align:center;color:#fff;font-size:.75em;letter-spacing:2px;font-weight:700;margin:0;padding:0}#nav ul li{display:inline}#nav ul li a,#nav ul li span{color:#fff;background-color:#084262;text-decoration:none;float:left;border-right:1px solid #7394B4;cursor:pointer;padding:.5em 11.5px}#nav ul li a:hover,#nav ul li span{color:#fff;background-color:#257B9D}@media print{#nav,#TOC,#TOC .toctitle,#TOC ul,#TOC ul ul,#TOC li{display:none}}</style>




</head>

<body>




<h1 class="title toc-ignore">Average Bioequivalence</h1>


<div id="TOC">
<ul>
<li><a href="#defaults" id="toc-defaults">Defaults</a></li>
<li><a href="#sample-size" id="toc-sample-size">Sample size</a>
<ul>
<li><a href="#example-1" id="toc-example-1">Example 1</a></li>
<li><a href="#example-2" id="toc-example-2">Example 2</a></li>
<li><a href="#expl3" id="toc-expl3">Example 3</a>
<ul>
<li><a href="#expl3basic" id="toc-expl3basic">Basic</a></li>
<li><a href="#expl3adv" id="toc-expl3adv">Advanced</a></li>
</ul></li>
<li><a href="#expl4" id="toc-expl4">Example 4</a></li>
<li><a href="#expl5" id="toc-expl5">Example 5</a></li>
<li><a href="#higher-order-designs" id="toc-higher-order-designs">Higher-Order Designs</a></li>
</ul></li>
<li><a href="#power" id="toc-power">Power</a></li>
<li><a href="#pooling" id="toc-pooling">Pooling</a></li>
<li><a href="#hints" id="toc-hints">Hints</a>
<ul>
<li><a href="#power-analysis" id="toc-power-analysis">Power
Analysis</a></li>
<li><a href="#dropouts" id="toc-dropouts">Dropouts</a></li>
<li><a href="#literature-data" id="toc-literature-data">Literature
Data</a></li>
<li><a href="#direction-of-deviation" id="toc-direction-of-deviation">Direction of Deviation</a></li>
</ul></li>
<li><a href="#authors" id="toc-authors">Authors</a></li>
<li><a href="#license" id="toc-license">License</a></li>
</ul>
</div>

<div class="top">
<a class="toplink" href="#nav" title="⇑ top"> </a>
</div>
<div id="nav">
<ul>
<li>
<a href="vignette.html">Main Vignette</a>
</li>
<li>
<span title="» You are here «">ABE</span>
</li>
<li>
<a href="RSABE.html" title="Reference-scaled Average Bioequivalence">RSABE</a>
</li>
<li>
<a href="NI.html">Non-Inferiority</a>
</li>
<li>
<a href="DP.html">Dose-Proportionality</a>
</li>
<li>
<a href="PA.html">Power Analysis</a>
</li>
</ul>
</div>
<h3>
Details and examples of other methods are accessible via the menu bar on
top of the page and in the
<a href="https://cran.r-project.org/package=PowerTOST/PowerTOST.pdf" title="PDF">Online
manual</a> of all functions.
</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(PowerTOST) <span class="co"># attach the library</span></span></code></pre></div>
<div id="defaults" class="section level1">
<h1>Defaults</h1>
<table>
<colgroup>
<col width="3%" />
<col width="17%" />
<col width="53%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Argument</th>
<th>Purpose</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\small{\alpha}\)</span></td>
<td><code>alpha</code></td>
<td>Nominal level of the test</td>
<td><code>0.05</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\small{\pi}\)</span></td>
<td><code>targetpower</code></td>
<td><span title="typically 0.80 – 0.90">Minimum desired
power</span></td>
<td><code>0.80</code></td>
</tr>
<tr class="odd">
<td>logscale</td>
<td><code>logscale</code></td>
<td>Analysis on log-transformed or original scale?</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\small{\theta_0}\)</span></td>
<td><code>theta0</code></td>
<td>‘True’ or assumed deviation of T from R</td>
<td>see below</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\small{\theta_1}\)</span></td>
<td><code>theta1</code></td>
<td>Lower BE limit</td>
<td>see below</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\small{\theta_2}\)</span></td>
<td><code>theta2</code></td>
<td>Upper BE limit</td>
<td>see below</td>
</tr>
<tr class="odd">
<td><em>CV</em></td>
<td><code>CV</code></td>
<td>CV</td>
<td>none</td>
</tr>
<tr class="even">
<td>design</td>
<td><code>design</code></td>
<td>Planned design</td>
<td><code>&quot;2x2&quot;</code></td>
</tr>
<tr class="odd">
<td>method</td>
<td><code>method</code></td>
<td>Algorithm</td>
<td><code>&quot;exact&quot;</code></td>
</tr>
<tr class="even">
<td>robust</td>
<td><code>robust</code></td>
<td>‘Robust’ evaluation (Senn’s basic estimator)</td>
<td><code>FALSE</code></td>
</tr>
<tr class="odd">
<td>print</td>
<td><code>print</code></td>
<td>Show information in the console?</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td>details</td>
<td><code>details</code></td>
<td>Show details of the sample size search?</td>
<td><code>FALSE</code></td>
</tr>
<tr class="odd">
<td>imax</td>
<td><code>imax</code></td>
<td>Maximum number of iterations</td>
<td><code>100</code></td>
</tr>
</tbody>
</table>
<p>Defaults depending on the argument <code>logscale</code>:</p>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Argument</th>
<th align="center"><code>logscale = TRUE</code></th>
<th align="center"><code>logscale = FALSE</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\small{\theta_0}\)</span></td>
<td><code>theta0</code></td>
<td align="center"><code>0.95</code></td>
<td align="center"><code>+0.05</code></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\small{\theta_1}\)</span></td>
<td><code>theta1</code></td>
<td align="center"><code>0.80</code></td>
<td align="center"><code>−0.20</code></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\small{\theta_2}\)</span></td>
<td><code>theta2</code></td>
<td align="center"><code>1.25</code></td>
<td align="center"><code>+0.20</code></td>
</tr>
</tbody>
</table>
<p>Arguments <code>targetpower</code>, <code>theta0</code>,
<code>theta1</code>, <code>theta2</code>, and <code>CV</code> have to be
given as fractions, not in percent.<br />
The <em>CV</em> is generally the <em>within</em>- (intra-) subject
coefficient of variation. Only for <code>design = &quot;parallel&quot;</code> it
is the <em>total</em> (<span title="also known as">a.k.a.</span> pooled)
<em>CV</em>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p>The terminology of the argument <code>design</code> follows this
pattern: <code>treatments x sequences x periods</code>. The conventional
TR|RT (<span title="also known as">a.k.a.</span> AB|BA) design can be
abbreviated as <code>&quot;2x2&quot;</code>. Some call the <code>&quot;parallel&quot;</code>
design a ‘one-sequence’ design. The design <code>&quot;paired&quot;</code> has two
periods but no sequences and is the standard design for studying linear
pharmacokinetics (where a single dose is followed by multiple doses). A
profile in steady state (T) is compared to the one after the single dose
(R). Note that the underlying model assumes no period effects.</p>
<p>Implemented exact algorithms are <code>&quot;exact&quot;</code> /
<code>&quot;owenq&quot;</code> (Owen’s Q function, default)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> and <code>&quot;mvt&quot;</code>
(direct integration of the bivariate non-central
<em>t</em>-distribution). Approximations are <code>&quot;noncentral&quot;</code> /
<code>&quot;nct&quot;</code> (non-central <em>t</em>-distribution) and
<code>&quot;shifted&quot;</code> / <code>&quot;central&quot;</code> (‘shifted’ central
<em>t</em>-distribution).</p>
<p><code>&quot;robust = TRUE&quot;</code> forces the degrees of freedom to
<code>n-seq</code> and is used only in higher-order crossover designs.
It could be used if the evaluation was done with a mixed-effects
model.</p>
<p>With <code>sampleN.TOST(..., print = FALSE)</code> results are
provided as a data frame<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> with nine columns <code>Design</code>,
<code>alpha</code>, <code>CV</code>, <code>theta0</code>,
<code>theta1</code>, <code>theta2</code>, <code>Sample size</code>,
<code>Achieved power</code>, and <code>Target power</code>.<br />
To access <em>e.g.</em>, the sample size use either
<code>sampleN.TOST(...)[7]</code> or
<code>sampleN.TOST(...)[[&quot;Sample size&quot;]]</code>. We suggest to use the
latter in scripts for clarity.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<p><span class="hl">The estimated sample size gives always the
<em>total</em> number of subjects (not subject/sequence in crossovers or
subjects/group in a parallel design – like in some other software
packages).</span></p>
</div>
<div id="sample-size" class="section level1">
<h1>Sample size</h1>
<p>Designs with one (parallel) to four periods (replicates) are
supported.</p>
<pre><code>#     design                        name   df
# &quot;parallel&quot;           2 parallel groups  n-2
#      &quot;2x2&quot;               2x2 crossover  n-2
#    &quot;2x2x2&quot;             2x2x2 crossover  n-2
#    &quot;2x2x3&quot;   2x2x3 replicate crossover 2n-3
#    &quot;2x2x4&quot;   2x2x4 replicate crossover 3n-4
#    &quot;2x4x4&quot;   2x4x4 replicate crossover 3n-4
#    &quot;2x3x3&quot;   partial replicate (2x3x3) 2n-3
#    &quot;2x4x2&quot;            Balaam’s (2x4x2)  n-2
#   &quot;2x2x2r&quot; Liu’s 2x2x2 repeated x-over 3n-2
#   &quot;paired&quot;                paired means  n-1</code></pre>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>Estimate the sample size for assumed intra-subject <em>CV</em>
0.30.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> <span class="fl">0.30</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># +++++++++++ Equivalence test - TOST +++++++++++</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#             Sample size estimation</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co"># Study design: 2x2 crossover </span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co"># log-transformed data (multiplicative model)</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># alpha = 0.05, target power = 0.8</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># BE margins = 0.8 ... 1.25 </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co"># True ratio = 0.95,  CV = 0.3</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co"># Sample size (total)</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#  n     power</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co"># 40   0.815845</span></span></code></pre></div>
<p>To get only the sample size:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> <span class="fl">0.30</span>, <span class="at">details =</span> <span class="cn">FALSE</span>, <span class="at">print =</span> <span class="cn">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># [1] 40</span></span></code></pre></div>
<p>Note that the sample size is always rounded up to give balanced
sequences (here a multiple of two). Since power is higher than our
target, likely this was the case here. Let us check that.<br />
Which power will we get with a sample size of 39?</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">power.TOST</span>(<span class="at">CV =</span> <span class="fl">0.30</span>, <span class="at">n =</span> <span class="dv">39</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># Unbalanced design. n(i)=20/19 assumed.</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># [1] 0.8056171</span></span></code></pre></div>
<p>Confirmed that with 39 subjects we will already reach the target
power. That means also that one dropout will not compromise power. We
could explore that further in a <a href="PA.html">Power
Analysis</a>.</p>
<p>Note that <code>sampleN.TOST()</code> is not vectorized. If we are
interested in combinations of assumed values:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>sampleN.TOST.vectorized <span class="ot">&lt;-</span> <span class="cf">function</span>(CVs, theta0s, ...) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> power <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="fu">length</span>(CVs), <span class="at">nrow =</span> <span class="fu">length</span>(theta0s))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(theta0s)) {</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(CVs)) {</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>      tmp         <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CVs[j], <span class="at">theta0 =</span> theta0s[i], ...)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>      n[i, j]     <span class="ot">&lt;-</span> tmp[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>      power[i, j] <span class="ot">&lt;-</span> tmp[[<span class="st">&quot;Achieved power&quot;</span>]]</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    }</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  }</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  DecPlaces <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">match</span>(<span class="cn">TRUE</span>, <span class="fu">round</span>(x, <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) <span class="sc">==</span> x)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  fmt.col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;CV %.&quot;</span>,    <span class="fu">max</span>(<span class="fu">sapply</span>(CVs, <span class="at">FUN =</span> DecPlaces),</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>                                    <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;f&quot;</span>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  fmt.row <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;theta %.&quot;</span>, <span class="fu">max</span>(<span class="fu">sapply</span>(theta0s, <span class="at">FUN =</span> DecPlaces),</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>                                    <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">&quot;f&quot;</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="fu">colnames</span>(power) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(n) <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(fmt.col, CVs)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>  <span class="fu">rownames</span>(power) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(n) <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(fmt.row, theta0s)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> n, <span class="at">power =</span> power)</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>  <span class="fu">return</span>(res)</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>}</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>CVs     <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.20</span>, <span class="fl">0.40</span>, <span class="fl">0.05</span>)</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>theta0s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.01</span>)</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>x       <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST.vectorized</span>(<span class="at">CV =</span> CVs, <span class="at">theta0 =</span> theta0s,</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>                                   <span class="at">details =</span> <span class="cn">FALSE</span>, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample size</span><span class="sc">\n</span><span class="st">&quot;</span>); <span class="fu">print</span>(x<span class="sc">$</span>n); <span class="fu">cat</span>(<span class="st">&quot;Achieved power</span><span class="sc">\n</span><span class="st">&quot;</span>); <span class="fu">print</span>(<span class="fu">signif</span>(x<span class="sc">$</span>power, <span class="at">digits =</span> <span class="dv">5</span>))</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co"># Sample size</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#            CV 0.20 CV 0.25 CV 0.30 CV 0.35 CV 0.40</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co"># theta 0.90      38      56      80     106     134</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co"># theta 0.91      32      48      66      88     112</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co"># theta 0.92      28      40      56      76      96</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co"># theta 0.93      24      36      50      66      84</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co"># theta 0.94      22      32      44      58      74</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co"># theta 0.95      20      28      40      52      66</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co"># Achieved power</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#            CV 0.20 CV 0.25 CV 0.30 CV 0.35 CV 0.40</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co"># theta 0.90 0.81549 0.80358 0.80801 0.80541 0.80088</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co"># theta 0.91 0.81537 0.81070 0.80217 0.80212 0.80016</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co"># theta 0.92 0.82274 0.80173 0.80021 0.80678 0.80238</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co"># theta 0.93 0.81729 0.81486 0.81102 0.80807 0.80655</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co"># theta 0.94 0.83063 0.81796 0.81096 0.80781 0.80740</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co"># theta 0.95 0.83468 0.80744 0.81585 0.80747 0.80525</span></span></code></pre></div>
<p>Perhaps the capacity of the clinical site is limited. Any study can
also be performed in a replicate design and assessed for ABE. As a rule
of thumb the total sample in a 3-period replicate is ~¾ of the 2×2×2
crossover and the one of a 2-sequence 4-period replicate ~½ of the
2×2×2. The number of treatments and hence, of biosamples – which mainly
drives the study’s cost – will be roughly the same.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>designs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2x2x2&quot;</span>, <span class="st">&quot;2x2x3&quot;</span>, <span class="st">&quot;2x3x3&quot;</span>, <span class="st">&quot;2x2x4&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co"># data.frame of results</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">design =</span> designs, <span class="at">n =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                  <span class="at">power =</span> <span class="cn">NA_real_</span>, <span class="at">n.do =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                  <span class="at">power.do =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="co"># this line for R &lt;4.0.0</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="co"># print = FALSE suppresses output to the console</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="co"># we are only interested in columns 7-8</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="co"># let&#39;s also calculate power for one dropout</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  res[i, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> <span class="fl">0.30</span>, <span class="at">design =</span> res<span class="sc">$</span>design[i],</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>                              <span class="at">print =</span> <span class="cn">FALSE</span>)[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  res[i, <span class="dv">4</span>]   <span class="ot">&lt;-</span> res[i, <span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  res[i, <span class="dv">5</span>]   <span class="ot">&lt;-</span> <span class="fu">suppressMessages</span>(</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>                    <span class="fu">power.TOST</span>(<span class="at">CV =</span> <span class="fl">0.30</span>, <span class="at">design =</span> res<span class="sc">$</span>design[i],</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>                               <span class="at">n =</span> res[i, <span class="dv">4</span>]))</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>}</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#  design  n     power n.do  power.do</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#   2x2x2 40 0.8158453   39 0.8056171</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#   2x2x3 30 0.8204004   29 0.8068731</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#   2x3x3 30 0.8204004   29 0.8063834</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#   2x2x4 20 0.8202398   19 0.7991508</span></span></code></pre></div>
<p>As expected – and as a bonus – we obtain a small gain in power,
though in the 4-period design with one dropout power will be slightly
compromised.<br />
But why is power in the replicate designs higher than in the 2×2×2
crossover? If residual variances are equal, the width of the confidence
interval depends only on the <em>t</em>-value and in particular on the
degrees of freedom – which themselves depend on the design and the
sample size.</p>
<pre><code>#  design                      name  n formula df t.value
#   2x2x2           2x2x2 crossover 40     n-2 38   1.686
#   2x2x3 2x2x3 replicate crossover 30   2*n-3 57   1.672
#   2x3x3 partial replicate (2x3x3) 30   2*n-3 57   1.672
#   2x2x4 2x2x4 replicate crossover 20   3*n-4 56   1.673</code></pre>
<p>If the capacity is 24 beds, we would opt for a 4-period full
replicate.</p>
<p>As another option (<em>e.g.</em>, if the blood volume is limited
and/or there are concerns about a higher dropout-rate in a
multiple-period study) we could stay with the 2×2×2 crossover but split
the sample size into groups. In Europe (and for the FDA if certain
conditions<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> are fulfilled), there are no problems
pooling the data and use the conventional model.</p>
<pre><code>sequence + subject(sequence) + period + treatment</code></pre>
<p>However, some regulators prefer to incorporate group-terms in the
model.</p>
<pre><code>group + sequence + subject(group × sequence) + 
period(group) + group × sequence + treatment</code></pre>
<p>Since we have more terms in the model, we will loose some degrees of
freedom. Let us explore in simulations how that would impact power. By
default function <code>power.TOST.sds()</code> performs 100,000
simulations.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>grouping <span class="ot">&lt;-</span> <span class="cf">function</span>(capacity, n) {</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="co"># split sample size into &gt;=2 groups based on capacity</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&lt;=</span> capacity) { <span class="co"># make equal groups</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    ngrp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">ceiling</span>(n <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">2</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  } <span class="cf">else</span> {             <span class="co"># at least one = capacity</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    ngrp    <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ceiling</span>(n <span class="sc">/</span> capacity))</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    grps    <span class="ot">&lt;-</span> <span class="fu">length</span>(ngrp)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    ngrp[<span class="dv">1</span>] <span class="ot">&lt;-</span> capacity</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>grps) {</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>      n.tot <span class="ot">&lt;-</span> <span class="fu">sum</span>(ngrp) <span class="co"># what we have so far</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>      <span class="cf">if</span> (n.tot <span class="sc">+</span> capacity <span class="sc">&lt;=</span> n) {</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>        ngrp[j] <span class="ot">&lt;-</span> capacity</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>        ngrp[j] <span class="ot">&lt;-</span> n <span class="sc">-</span> n.tot</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>      }</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    }</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  }</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">ngrp =</span> <span class="fu">list</span>(<span class="at">grps =</span> <span class="fu">length</span>(ngrp), <span class="at">ngrp =</span> ngrp))</span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>}</span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>CV        <span class="ot">&lt;-</span> <span class="fl">0.30</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>capacity  <span class="ot">&lt;-</span> <span class="dv">24</span> <span class="co"># clinical capacity</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>res       <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> <span class="cn">NA_integer_</span>, <span class="at">grps =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>                        <span class="at">n.grp =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>                        <span class="at">m.1 =</span> <span class="cn">NA_real_</span>, <span class="at">m.2 =</span> <span class="cn">NA_real_</span>)</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>x         <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV, <span class="at">print =</span> <span class="cn">FALSE</span>, <span class="at">details =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>res<span class="sc">$</span>n     <span class="ot">&lt;-</span> x[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>res<span class="sc">$</span>m<span class="fl">.1</span>   <span class="ot">&lt;-</span> x[[<span class="st">&quot;Achieved power&quot;</span>]]</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>x         <span class="ot">&lt;-</span> <span class="fu">grouping</span>(<span class="at">capacity =</span> capacity, <span class="at">n =</span> res<span class="sc">$</span>n)</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>res<span class="sc">$</span>grps  <span class="ot">&lt;-</span> x[[<span class="st">&quot;grps&quot;</span>]]</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>ngrp      <span class="ot">&lt;-</span> x[[<span class="st">&quot;ngrp&quot;</span>]]</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>res<span class="sc">$</span>n.grp <span class="ot">&lt;-</span> <span class="fu">paste</span>(ngrp, <span class="at">collapse =</span> <span class="st">&quot;|&quot;</span>)</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>res<span class="sc">$</span>m<span class="fl">.2</span>   <span class="ot">&lt;-</span> <span class="fu">power.TOST.sds</span>(<span class="at">CV =</span> CV, <span class="at">n =</span> res<span class="sc">$</span>n, <span class="at">grps =</span> res<span class="sc">$</span>grps,</span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>                            <span class="at">ngrp =</span> ngrp, <span class="at">gmodel =</span> <span class="dv">2</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>res<span class="sc">$</span>loss <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">*</span>(res<span class="sc">$</span>m<span class="fl">.2</span> <span class="sc">-</span> res<span class="sc">$</span>m<span class="fl">.1</span>) <span class="sc">/</span> res<span class="sc">$</span>m<span class="fl">.1</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="fu">names</span>(res)[<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;groups&quot;</span>, <span class="st">&quot;n/group&quot;</span>, <span class="st">&quot;pooled model&quot;</span>,</span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a>                     <span class="st">&quot;group model&quot;</span>, <span class="st">&quot;loss (%)&quot;</span>)</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>res[<span class="dv">1</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%6.4f&quot;</span>, res[<span class="dv">1</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Achieved power and relative loss</span><span class="sc">\n</span><span class="st">&quot;</span>); <span class="fu">print</span>(res, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co"># Achieved power and relative loss</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#   n groups n/group pooled model group model loss (%)</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#  40      2   24|16       0.8158      0.8120  -0.4664</span></span></code></pre></div>
<p>With ~0.5% the relative loss in power is practically negligible.</p>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>Estimate the sample size for equivalence of the ratio of two means
with normality on original scale based on Fieller’s (‘fiducial’)
confidence interval.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> Crossover design, within-subject
<em>CV</em><sub>w</sub> 0.20, between-subject <em>CV</em><sub>b</sub>
0.40.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">sampleN.RatioF</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">CVb =</span> <span class="fl">0.40</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># +++++++++++ Equivalence test - TOST +++++++++++</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#     based on Fieller&#39;s confidence interval</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#             Sample size estimation</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co"># Study design: 2x2 crossover</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># Ratio of means with normality on original scale</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co"># alpha = 0.025, target power = 0.8</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># BE margins = 0.8 ... 1.25 </span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co"># True ratio = 0.95,  CVw = 0.2,  CVb = 0.4</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co"># Sample size</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#  n     power</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co"># 28   0.807774</span></span></code></pre></div>
<p>In this function the default <span class="math inline">\(\small{\alpha}\)</span> is 0.025, since it is
intended for studies with clinical endpoints, where the 95% confidence
interval is usually used for equivalence testing.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
</div>
<div id="expl3" class="section level2">
<h2>Example 3</h2>
<p>Estimate the sample size based on the results of a 2×2×2 pilot study
in 16 subjects where we observed an intra-subject <em>CV</em> 0.20 and
<span class="math inline">\(\small{\theta_0}\)</span> 0.92.</p>
<div id="expl3basic" class="section level3">
<h3>Basic</h3>
<p>If we believe [<em>sic</em>] that in the pivotal study both the <span class="math inline">\(\small{\theta_0}\)</span> and <em>CV</em> will be
<em>exactly</em> like in the pilot, this is a straightforward exercise.
We simply provide the required arguments.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">theta0 =</span> <span class="fl">0.92</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co"># +++++++++++ Equivalence test - TOST +++++++++++</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#             Sample size estimation</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co"># Study design: 2x2 crossover </span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co"># log-transformed data (multiplicative model)</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># alpha = 0.05, target power = 0.8</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co"># BE margins = 0.8 ... 1.25 </span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co"># True ratio = 0.92,  CV = 0.2</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co"># Sample size (total)</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#  n     power</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co"># 28   0.822742</span></span></code></pre></div>
<p>This approach is called by some ‘carved in stone’ because it relies
on – very strong – assumptions which likely are not justified. Although
power curves are relatively flat close to unity (<em>i.e.</em>, the
impact on power is small when moving from say, <span class="math inline">\(\small{\theta_0}\)</span> 1 to 0.95) but they are
getting increasingly steep when moving away more from unity.</p>
<div class="float">
<img src="data:image/png;base64,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" width="355" alt="Fig. 1 Power curve (\small{\alpha} 0.05, 2×2×2 design, CV 0.20; blue n = 28, black n = 22, red n = 16)" />
<div class="figcaption"><strong>Fig. 1</strong> Power curve (<span class="math inline">\(\small{\alpha}\)</span> 0.05, 2×2×2 design,
<em>CV</em> 0.20;<br />blue n = 28, black n = 22, red n = 16)</div>
</div>
<p>Both <span class="math inline">\(\small{\theta_0}\)</span> and
<em>CV</em> (as every estimate) are uncertain to some extent, which
depends on the degrees of freedom (sample size and design). Hence, it
might not be good idea to perform very small pilot studies
(<em>e.g.</em>, in only six subjects). Although it might be possible
that in the pivotal study the <em>CV</em> is indeed <em>lower</em> than
the one we observed in the pilot, it would be even more risky than the
‘carved in stone’ approach to assume a lower one in planning the pivotal
study.</p>
<p>With the function <code>CVCL()</code> we can calculate confidence
limits of the <em>CV</em>. It is advisable to use the upper confidence
limit as a conservative approach. As a side effect – if the <em>CV</em>
will be lower than assumed – we get a ‘safety margin’ for the T/R
ratio.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">16</span> <span class="sc">-</span> <span class="dv">2</span> <span class="co"># degrees of freedom of the 2x2x2 crossover pilot</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">CVCL</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">df =</span> df, <span class="at">side =</span> <span class="st">&quot;upper&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.20</span>)[[<span class="st">&quot;upper CL&quot;</span>]]</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># [1] 0.2443631</span></span></code></pre></div>
<p>I prefer <span class="math inline">\(\small{\alpha=0.20}\)</span> in
analogy to the producer’s risk <span class="math inline">\(\small{\beta=0.20}\)</span> when planning for
power <span class="math inline">\(\small{\pi=1-\beta=0.80}\)</span>.
Gould proposed the more liberal <span class="math inline">\(\small{\alpha=0.25}\)</span>.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> Let us repeat the
sample size estimation based on the upper <span title="Confidence Limit">CL</span> of the CV.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>CL.upper <span class="ot">&lt;-</span> <span class="fu">CVCL</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">df =</span> <span class="dv">16</span> <span class="sc">-</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">&quot;upper&quot;</span>,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.20</span>)[[<span class="st">&quot;upper CL&quot;</span>]]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CL.upper, <span class="at">theta0 =</span> <span class="fl">0.92</span>, <span class="at">print =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="fu">print</span>(res[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>], <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#  Sample size Achieved power</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#           40       0.816919</span></span></code></pre></div>
<p>Of course, this has a massive impact on the sample size, which
increases from 28 to 40. It might be difficult to convince the
management to invest ~40% more than with the ‘carved in stone’
approach.</p>
<p>However, we can also explore how power would be affected if our
assumption is true and the study will nevertheless be performed with
only 28 subjects.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>CL.upper <span class="ot">&lt;-</span> <span class="fu">CVCL</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">df =</span> <span class="dv">16</span> <span class="sc">-</span> <span class="dv">2</span>, <span class="at">side =</span> <span class="st">&quot;upper&quot;</span>,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.20</span>)[[<span class="st">&quot;upper CL&quot;</span>]]</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">power.TOST</span>(<span class="at">CV =</span> CL.upper, <span class="at">theta0 =</span> <span class="fl">0.92</span>, <span class="at">n =</span> <span class="dv">28</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># [1] 0.679253</span></span></code></pre></div>
<p>There will be a drop in power from the ~0.82 the management expects
to only ~0.67. That’s just slightly higher than betting for two dozens
in Roulette…</p>
<div class="float">
<img src="data:image/png;base64,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" width="354" alt="Fig. 2 Power for CV 0.244" />
<div class="figcaption"><strong>Fig. 2</strong> Power for <em>CV</em>
0.244</div>
</div>
<p>As mentioned above, if the <em>CV</em> turns out to be lower than
assumed, we gain a ‘safety margin’ for the T/R ratio. Let us explore
that. We perform the study with 40 subjects, the <em>CV</em> will be
0.22 (<em>less</em> than the ~0.24 we assumed), and the T/R with 0.90
will be <em>worse</em> than the 0.92 we assumed.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">power.TOST</span>(<span class="at">CV =</span> <span class="fl">0.22</span>, <span class="at">theta0 =</span> <span class="fl">0.90</span>, <span class="at">n =</span> <span class="dv">40</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># [1] 0.7686761</span></span></code></pre></div>
<p>Below our target but still acceptable.</p>
</div>
<div id="expl3adv" class="section level3">
<h3>Advanced</h3>
<p>In the <a href="#expl3basic">basic approach</a> we concentrated
mainly on the uncertainty of the <em>CV</em>. But this is not the end of
the story. Clearly <span class="math inline">\(\small{\theta_0}\)</span>
is uncertain as well. With the function <code>expsampleN.TOST()</code>
we can dive deeper into this matter. Let us start with the <em>CV</em>
only.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">expsampleN.TOST</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">theta0 =</span> <span class="fl">0.92</span>, <span class="at">prior.type =</span> <span class="st">&quot;CV&quot;</span>,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                <span class="at">prior.parm =</span> <span class="fu">list</span>(<span class="at">m =</span> <span class="dv">16</span>, <span class="at">design =</span> <span class="st">&quot;2x2x2&quot;</span>))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co"># ++++++++++++ Equivalence test - TOST ++++++++++++</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#        Sample size est. with uncertain CV</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co"># -------------------------------------------------</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co"># Study design:  2x2 crossover </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co"># log-transformed data (multiplicative model)</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co"># alpha = 0.05, target power = 0.8</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co"># BE margins = 0.8 ... 1.25 </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># Ratio = 0.92</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co"># CV = 0.2 with 14 df</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co"># Sample size (ntotal)</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#  n   exp. power</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co"># 30   0.806069</span></span></code></pre></div>
<p>Not that bad. The sample size increases fairly from the 28 of the
‘carved in stone’ approach to 30 but is substantially lower than the 40
we estimated based on the upper confidence limit of the <em>CV</em>.</p>
<p>Let us keep the <em>CV</em> ‘fixed’ and take only the uncertainty of
<span class="math inline">\(\small{\theta_0}\)</span> into account.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">expsampleN.TOST</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">theta0 =</span> <span class="fl">0.92</span>, <span class="at">prior.type =</span> <span class="st">&quot;theta0&quot;</span>,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                <span class="at">prior.parm =</span> <span class="fu">list</span>(<span class="at">m =</span> <span class="dv">16</span>, <span class="at">design =</span> <span class="st">&quot;2x2x2&quot;</span>))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co"># ++++++++++++ Equivalence test - TOST ++++++++++++</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#      Sample size est. with uncertain theta0</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co"># -------------------------------------------------</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co"># Study design:  2x2 crossover </span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co"># log-transformed data (multiplicative model)</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co"># alpha = 0.05, target power = 0.8</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co"># BE margins = 0.8 ... 1.25 </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co"># Ratio = 0.92</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co"># CV = 0.2</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co"># Sample size (ntotal)</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#  n   exp. power</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co"># 46   0.805236</span></span></code></pre></div>
<p>It starts to hurt. We saw already that power curves are getting steep
if the T/R ratio is not close to unity. Our <span class="math inline">\(\small{\theta_0}\)</span> 0.92 was not very nice
but in the pivotal study it might be even lower as well – which has a
larger impact on power than the <em>CV</em>.</p>
<p>Now for the ‘worst case scenario’, where we take both uncertainties
into account.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">expsampleN.TOST</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">theta0 =</span> <span class="fl">0.92</span>, <span class="at">prior.type =</span> <span class="st">&quot;both&quot;</span>,</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>                <span class="at">prior.parm =</span> <span class="fu">list</span>(<span class="at">m =</span> <span class="dv">16</span>, <span class="at">design =</span> <span class="st">&quot;2x2x2&quot;</span>),</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                <span class="at">details =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co"># ++++++++++++ Equivalence test - TOST ++++++++++++</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#   Sample size est. with uncertain CV and theta0</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co"># -------------------------------------------------</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co"># Study design:  2x2 crossover </span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co"># log-transformed data (multiplicative model)</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co"># alpha = 0.05, target power = 0.8</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co"># BE margins = 0.8 ... 1.25 </span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co"># Ratio = 0.92 with 14 df</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co"># CV = 0.2 with 14 df</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co"># Sample size (ntotal)</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#  n   exp. power</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co"># 54   0.802440</span></span></code></pre></div>
<p>This sample size is almost twice the 28 your boss got from a popular
Excel-Sheet.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> If you are not fired right away when
suggesting such a study, take it as a warning what <em>might</em>
happen.<br />
At least, if the pivotal study is performed in a lower sample size and
fails, <em>you</em> know why.</p>
<div class="float">
<img src="data:image/png;base64,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" width="354" alt="Fig. 3 Expected power for uncertain estimates (from top: CV, \theta_0, both)" />
<div class="figcaption"><strong>Fig. 3</strong> Expected power for
uncertain estimates (from top: <em>CV</em>, <span class="math inline">\(\theta_0\)</span>, both)</div>
</div>
<p>If you are adventurous, consider an Adaptive Two-Stage Sequential
Design with sample size re-estimation. Various methods are provided in
the package <code>Power2Stage</code>.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
</div>
</div>
<div id="expl4" class="section level2">
<h2>Example 4</h2>
<p>An alternative to an assumed <span class="math inline">\(\small{\theta_0}\)</span> is <em>‘Statistical
Assurance’</em>.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> This concept uses the distribution of
T/R-ratios and assumes an uncertainty parameter <span class="math inline">\(\small{\sigma_\textrm{u}}\)</span>. A natural
assumption is <span class="math inline">\(\small{\sigma_\textrm{u}=1-\theta_0}\)</span>,
<em>i.e.</em>, for the commonly applied <span class="math inline">\(\small{\theta_0=0.95}\)</span> one can use the
argument <code>sem = 0.05</code> of the function
<code>expsampleN.TOST()</code> where the argument <code>theta0</code>
<strong>must</strong> be kept at 1. The following example reproduces
Table 1 of the paper.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>CV  <span class="ot">&lt;-</span> <span class="fl">0.214</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">target =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.8</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="fl">0.9</span>, <span class="dv">5</span>)),</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                  <span class="at">theta0 =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">seq</span>(<span class="fl">0.95</span>, <span class="fl">0.92</span>, <span class="sc">-</span><span class="fl">0.01</span>)), <span class="dv">2</span>),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>                  <span class="at">n.1 =</span> <span class="cn">NA_integer_</span>, <span class="at">power =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>                  <span class="at">sigma.u =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.0005</span>, <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.08</span>, <span class="fl">0.01</span>)), <span class="dv">2</span>),</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>                  <span class="at">n.2 =</span> <span class="cn">NA_integer_</span>, <span class="at">assurance =</span> <span class="cn">NA_real_</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(res)) {</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  res[i, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV, <span class="at">targetpower =</span> res<span class="sc">$</span>target[i],</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>                              <span class="at">theta0 =</span> res<span class="sc">$</span>theta0[i], <span class="at">print =</span> <span class="cn">FALSE</span>)[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>  res[i, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="fu">expsampleN.TOST</span>(<span class="at">CV =</span> CV, <span class="at">targetpower =</span> res<span class="sc">$</span>target[i],</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>                                 <span class="at">theta0 =</span> <span class="dv">1</span>, <span class="co"># mandatory!</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>                                 <span class="at">prior.type =</span> <span class="st">&quot;theta0&quot;</span>,</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>                                 <span class="at">prior.parm =</span> <span class="fu">list</span>(<span class="at">sem =</span> res<span class="sc">$</span>sigma.u[i]),</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>                                 <span class="at">print =</span> <span class="cn">FALSE</span>)[<span class="dv">9</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>}</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>res                 <span class="ot">&lt;-</span> <span class="fu">signif</span>(res, <span class="dv">3</span>)</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>res[, <span class="dv">5</span>]            <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.2f&quot;</span>, res[, <span class="dv">5</span>])</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="fu">names</span>(res)[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#  target theta0  n power sigma.u  n assurance</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#     0.8   1.00 18 0.833    0.00 18     0.833</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#     0.8   0.95 22 0.824    0.05 22     0.833</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#     0.8   0.94 24 0.817    0.06 22     0.800</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#     0.8   0.93 26 0.801    0.07 26     0.819</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#     0.8   0.92 30 0.802    0.08 28     0.803</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#     0.9   1.00 22 0.916    0.00 22     0.916</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co">#     0.9   0.95 28 0.904    0.05 28     0.904</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="co">#     0.9   0.94 32 0.909    0.06 32     0.903</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#     0.9   0.93 36 0.905    0.07 38     0.902</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co">#     0.9   0.92 42 0.908    0.08 48     0.902</span></span></code></pre></div>
<p>One caveat: Assuming <em>no</em> uncertainty (<span class="math inline">\(\small{\sigma_\textrm{u}=0}\)</span>) would fail
because the level of technical success is zero. Here a small value of
0.0005 was used instead.</p>
</div>
<div id="expl5" class="section level2">
<h2>Example 5</h2>
<p>Estimate the sample size for a study of two blood pressure lowering
drugs in a 2×2×2 design assessing the difference in means of
untransformed data (raw, linear scale; <em>i.e.</em>, specifying
<code>logscale = FALSE</code>). In this setup everything has to be given
with the same units (<em>i.e.</em>, here <span class="math inline">\(\small{\theta_0}\)</span> –5 mm Hg, <span class="math inline">\(\small{\theta_1}\)</span> –15 mm Hg, <span class="math inline">\(\small{\theta_2}\)</span> +15 mm Hg systolic <span title="Blood Pressure">BP</span>).</p>
<p>Assuming a residual standard deviation 20 mm Hg.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>planned  <span class="ot">&lt;-</span> <span class="st">&quot;2x2x2&quot;</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>logscale <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>theta0   <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>theta1   <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">15</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>theta2   <span class="ot">&lt;-</span> <span class="sc">+</span><span class="dv">15</span> <span class="co"># if not given, -theta1 is used</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>SD.resid <span class="ot">&lt;-</span>  <span class="dv">20</span> <span class="co"># residual standard deviation</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> SD.resid, <span class="at">theta0 =</span> theta0, <span class="at">theta1 =</span> theta1,</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>             <span class="at">theta2 =</span> theta2, <span class="at">logscale =</span> logscale, <span class="at">design =</span> planned)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co"># +++++++++++ Equivalence test - TOST +++++++++++</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#             Sample size estimation</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co"># Study design: 2x2 crossover </span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co"># untransformed data (additive model)</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co"># alpha = 0.05, target power = 0.8</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co"># BE margins = -15 ... 15 </span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co"># True diff. = -5,  CV = 20</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co"># Sample size (total)</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#  n     power</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co"># 52   0.807468</span></span></code></pre></div>
<p>Assuming a standard deviation of the difference T – R 28 mm Hg.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>known    <span class="ot">&lt;-</span> <span class="fu">known.designs</span>()[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>)]           <span class="co"># extract relevant information</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>bk       <span class="ot">&lt;-</span> known[known<span class="sc">$</span>design <span class="sc">==</span> planned, <span class="st">&quot;bk&quot;</span>] <span class="co"># retrieve design constant</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>txt      <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;The design constant for design </span><span class="sc">\&quot;</span><span class="st">&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>                   planned, <span class="st">&quot;</span><span class="sc">\&quot;</span><span class="st"> is &quot;</span>, bk)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>SD.delta <span class="ot">&lt;-</span>  <span class="dv">28</span>                                  <span class="co"># standard deviation of the difference</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>SD.resid <span class="ot">&lt;-</span>  SD.delta <span class="sc">/</span> <span class="fu">sqrt</span>(bk)                 <span class="co"># convert to residual SD</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">cat</span>(txt); <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> SD.resid, <span class="at">theta0 =</span> theta0,</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>                       <span class="at">theta1 =</span> theta1, <span class="at">theta2 =</span> theta2,</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>                       <span class="at">logscale =</span> logscale, <span class="at">design =</span> planned)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co"># The design constant for design &quot;2x2x2&quot; is 2</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co"># +++++++++++ Equivalence test - TOST +++++++++++</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#             Sample size estimation</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co"># Study design: 2x2 crossover </span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co"># untransformed data (additive model)</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co"># alpha = 0.05, target power = 0.8</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co"># BE margins = -15 ... 15 </span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co"># True diff. = -5,  CV = 19.79899</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co"># Sample size (total)</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#  n     power</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co"># 50   0.800423</span></span></code></pre></div>
<p>Note that other software packages (<em>e.g.</em>, PASS, nQuery,
StudySize,…) require the standard deviation of the difference as
input.</p>
</div>
<div id="higher-order-designs" class="section level2">
<h2>Higher-Order Designs</h2>
<p>Designs with three and four treatments/periods are supported.</p>
<pre><code>#  design            name   df
#   &quot;3x3&quot;   3x3 crossover 2n-4
# &quot;3x6x3&quot; 3x6x3 crossover 2n-4
#   &quot;4x4&quot;   4x4 crossover 3n-6</code></pre>
<p><code>&quot;3x3&quot;</code> denotes the Latin Square
(<code>ABC|BCA|CAB</code>), <code>&quot;3x6x3&quot;</code> the 6-sequence
Williams’ design (<code>ABC|ACB|BAC|BCA|CAB|CBA</code>),
<code>&quot;4x4&quot;</code> the Latin Square (<code>ABCD|BCDA|CDAB|DABC</code>)
or <em>any</em> of the possible Williams’ designs with four periods
(<code>ADBC|BACD|CBDA|DCAB</code>, <code>ADCB|BCDA|CABD|DBAC</code>,
<code>ACDB|BDCA|CBAD|DABC</code>, <code>ACBD|BADC|CDAB|DBCA</code>,
<code>ABDC|BCAD|CDBA|DACB</code>, <code>ABCD|BDAC|CADB|DCBA</code>).</p>
<p>Which <code>design</code> argument in studies with more than two
periods you should use depends on the planned evaluation.</p>
<blockquote>
Suppose we have a bioequivalence study with three treatments – A, B, and
C – and the objective of the study is to make pairwise comparisons among
the treatments. Suppose further that treatment C is different in kind
from A and B, so that the assumption of homogeneous variance among the
three treatments is questionable. One way to do the analyses, under
normality assumptions, is Two at a Time – e.g., to test hypotheses about
A and B, use only the data from A and B. Another way is All at Once –
include the data from all three treatments in a single analysis, making
pairwise comparisons within this analysis. If the assumption of
homogeneous variance is correct, the All at Once approach will provide
more <span title="degrees of freedom">d.f.</span> for estimating the
common variance, resulting in increased power. If the variance of C
differs from that of A and B, the All at Once approach may have reduced
power or an inflated type I error rate, depending on the direction of
the difference in variances.
<footer>
— Donald J. Schuirmann (2004)<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>
</footer>
</blockquote>
<ul>
<li><p><strong>All at Once</strong></p>
<p>In this approach you assume homogenicity in the ANOVA of pooled data
and get one residual variance.<br />
To plan for this approach specify one of the <code>design</code>
arguments given above.</p></li>
<li><p><strong>Two at a Time</strong></p>
<p>In this approach – which is preferred by some agencies,
<em>e.g.</em>, the EMA<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> <a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> – you exclude one treatment and perform
the analysis on the remaining two. That means, you obtain two
<em>separate</em> Incomplete Block Designs (IBD).<br />
One example is comparing a test (<code>T</code>) and to references from
two different regions (<code>R1</code>, <code>R2</code>). You get not
only two point estimates (like in the ANOVA) but also two within-subject
variances (in the comparisons <code>T</code> <em>vs</em> <code>R1</code>
and <code>T</code> <em>vs</em> <code>R2</code>).<br />
Another example is a pilot study with two candidate treatments
(<code>C1</code>, <code>C2</code>) and one reference (<code>R</code>).
You would select the candidate with <span class="math inline">\(\small{\min \left\{\left|
\log_{e}\theta_\textrm{C1}\right |,\left |
\log_{e}\theta_\textrm{C2}\right | \right \}}\)</span> for the pivotal
study. If <span class="math inline">\(\small{\left |
\log_{e}\theta_\textrm{C1}\right |\sim \left |
\log_{e}\theta_\textrm{C2}\right | }\)</span>, select the candidate with
lower within-subject variance.<br />
To plan for this approach specify
<code>design = &quot;2x2x2&quot;</code>.</p></li>
</ul>
<p>Apart from the regulatory recommendation we suggest this approach,
since the ‘All at Once’ approach may lead to biased estimates and an
inflated type I error.<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a></p>
<p>Three treatments intended for evaluation ‘All at Once’ or ‘Two at a
Time’.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>CV  <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">design =</span> <span class="fu">c</span>(<span class="st">&quot;3x6x3&quot;</span>, <span class="st">&quot;2x2x2&quot;</span>), <span class="at">n =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                  <span class="at">power =</span> <span class="cn">NA_real_</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  res[i, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV, <span class="at">design =</span> res<span class="sc">$</span>design[i],</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>                              <span class="at">print =</span> <span class="cn">FALSE</span>)[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>}</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#  design  n     power</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#   3x6x3 18 0.8089486</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#   2x2x2 20 0.8346802</span></span></code></pre></div>
<p>Four treatments (<em>e.g.</em>, Test fasting and fed, Reference
fasting and fed).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>CV  <span class="ot">&lt;-</span> <span class="fl">0.20</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">design =</span> <span class="fu">c</span>(<span class="st">&quot;4x4&quot;</span>, <span class="st">&quot;2x2x2&quot;</span>), <span class="at">n =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>                  <span class="at">power =</span> <span class="cn">NA_real_</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  res[i, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV, <span class="at">design =</span> res<span class="sc">$</span>design[i],</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>                              <span class="at">print =</span> <span class="cn">FALSE</span>)[<span class="dv">7</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>}</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#  design  n     power</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#     4x4 20 0.8527970</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#   2x2x2 20 0.8346802</span></span></code></pre></div>
</div>
</div>
<div id="power" class="section level1">
<h1>Power</h1>
<p>Let us first recap the hypotheses in bioequivalence.</p>
<ol style="list-style-type: decimal">
<li><p>The ‘Two One-Sided Tests Procedure’ (TOST)<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> <span class="math display">\[\small{H_\textrm{0L}:\frac{\mu_\textrm{T}}{\mu_\textrm{R}}
\leq
\theta_1\:vs\:H_\textrm{1L}:\frac{\mu_\textrm{T}}{\mu_\textrm{R}}&gt;\theta_1}\]</span>
<span class="math display">\[\small{H_\textrm{0U}:\frac{\mu_\textrm{T}}{\mu_\textrm{R}}
\geq
\theta_2\:vs\:H_\textrm{1U}:\frac{\mu_\textrm{T}}{\mu_\textrm{R}}&lt;\theta_2}\]</span></p></li>
<li><p>The confidence interval inclusion approach <span class="math display">\[\small{H_0:\frac{\mu_\textrm{T}}{\mu_\textrm{R}}\ni
\left\{ \theta_1, \theta_2
\right\}\:vs\:H_1:\theta_1&lt;\frac{\mu_\textrm{T}}{\mu_\textrm{R}}&lt;\theta_2}\]</span></p></li>
</ol>
<p>Note that the null hypotheses imply
bio<u><strong>in</strong></u>equivalence where <span class="math inline">\(\small{\left\{\theta_1,\theta_2\right\}}\)</span>
are the lower and upper limits of the bioequivalence range.<br />
TOST provides a pair of <span class="math inline">\(\small{p}\)</span>
values (where <span class="math inline">\(\small{H_0}\)</span> is not
rejected if <span class="math inline">\(\small{\max}(p_\textrm{L},p_\textrm{U})&gt;\alpha\)</span>)
and is of historical interest only because the <span title="Confidence Interval">CI</span> inclusion approach is preferred in
regulatory guidelines.</p>
<p>From a regulatory perspective the outcome of a comparative <span title="Bioavailability">BA</span> study is dichotomous. <span class="hl"> <em>Either</em> </span> the study demonstrated
bioequivalence (confidence interval entirely <em>within</em> <span class="math inline">\(\small{\left\{\theta_1,\theta_2\right\}}\)</span>)
<span class="hl"> <em>or</em> </span> not.<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a> Only if the <span title="Confidence Interval">CI</span> lies entirely <em>outside</em>
<span class="math inline">\(\small{\{\theta_1,\theta_2\}}\)</span>, the
null hypothesis is not rejected and further studies not warranted.<br />
In any case, calculation of <em>post hoc</em> (<span title="also known as">a.k.a.</span> <em>a posteriori</em>,
retrospective) power is futile.<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a></p>
<blockquote>
There is simple intuition behind results like these: If my car made it
to the top of the hill, then it is powerful enough to climb that hill;
if it didn’t, then it obviously isn’t powerful enough. Retrospective
power is an obvious answer to a rather uninteresting question. A more
meaningful question is to ask whether the car is powerful enough to
climb a particular hill never climbed before; or whether a different car
can climb that new hill. Such questions are prospective, not
retrospective.
<footer>
— Russell V. Lenth (2000)<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>
</footer>
</blockquote>
<p>If a study passes – despite lower than desired power – there is <a href="https://forum.bebac.at/forum_entry.php?id=13277#top13277" title="Being lucky is not a crime. (ElMaestro)">no reason to reject the
study</a>. It only means that assumptions (‼) in sample size estimation
were not realized. The <em>CV</em> might have been higher, and/or the
T/R-ratio worse, and/or the dropout-rate higher than anticipated. On the
other hand, if <em>post hoc</em> power is higher than desired, it does
not further support a study which already demonstrated BE.</p>
<p>Nevertheless, exploring power is useful when trying to understand why
a study failed and to plan another study. Let us continue with the <a href="#expl3">example</a> from above. Ignoring our concerns, the
management decided to perform the pivotal study with 28 subjects. The
T/R-ratio was slightly worse (0.90), the <em>CV</em> higher (0.25), and
we had one dropout in the first sequence and two in the second. The
function <code>CI.BE()</code> comes handy.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span> <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">14</span> <span class="sc">-</span> <span class="dv">2</span>) <span class="co"># 14 dosed in each sequence</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">CI.BE</span>(<span class="at">pe =</span> <span class="fl">0.90</span>, <span class="at">CV =</span> <span class="fl">0.25</span>, <span class="at">n =</span> n), <span class="dv">2</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#  lower  upper </span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#  79.87 101.42</span></span></code></pre></div>
<p>The study failed although by a small margin. One might be tempted to
repeat the study with an – only slightly – higher sample size. But what
was the <em>post hoc</em> power of the failed study?</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">power.TOST</span>(<span class="at">CV =</span> <span class="fl">0.25</span>, <span class="at">theta0 =</span> <span class="fl">0.90</span>, <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">12</span>)) <span class="co"># observed values</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="co"># [1] 0.4963175</span></span></code></pre></div>
<p>Actually the chance of passing was worse than tossing a coin.</p>
<p><span title="nota bene">NB</span>, in calculating <em>post hoc</em>
power the <em>observed</em> <span class="math inline">\(\small{\theta_0}\)</span> has to be used. In some
statistical reports high <em>‘power’</em> is given even for a
<em>failed</em> study, which is <a href="https://en.wikipedia.org/wiki/Not_even_wrong" title="Wolfgang Pauli">not even wrong</a>. Alas, <span class="math inline">\(\small{\theta_0=1}\)</span> is still the default
in some software packages.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">power.TOST</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">theta0 =</span> <span class="fl">0.92</span>, <span class="at">n =</span> <span class="dv">28</span>)     <span class="co"># assumed in planning</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="co"># [1] 0.822742</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="fu">power.TOST</span>(<span class="at">CV =</span> <span class="fl">0.25</span>, <span class="at">theta0 =</span> <span class="dv">1</span>, <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">12</span>)) <span class="co"># observed CV but wrong T/R-ratio</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co"># [1] 0.8558252</span></span></code></pre></div>
<p>Since all estimates were worse than assumed, how could one get a
‘power’ even higher than desired, despite the fact that the study
<em>failed</em> to demonstrate bioequivalence? That’s nonsense, of
course. <span class="math inline">\(\small{\theta_0=1}\)</span> gives
the ‘power to detect a significant difference of 20%’ – a flawed concept
which was abandoned after Schuirmann’s paper of 1987.</p>
</div>
<div id="pooling" class="section level1">
<h1>Pooling</h1>
<p>When planning the next study one can use the entire arsenal from <a href="#expl3">above</a>. Since we have more accurate estimates (from 25
subjects instead of the 16 of the pilot) the situation is more clear
now.<br />
As a further step we can take the information of both studies into
account with the function <code>CVpooled()</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>CVs <span class="ot">&lt;-</span> (<span class="st">&quot;  CV |  n | design | study</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="st">         0.20 | 16 |  2x2x2 | pilot</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="st">         0.25 | 25 |  2x2x2 | pivotal&quot;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>txtcon <span class="ot">&lt;-</span> <span class="fu">textConnection</span>(CVs)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>data   <span class="ot">&lt;-</span> <span class="fu">read.table</span>(txtcon, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;|&quot;</span>,</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>                     <span class="at">strip.white =</span> <span class="cn">TRUE</span>, <span class="at">as.is =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="fu">close</span>(txtcon)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">CVpooled</span>(data, <span class="at">alpha =</span> <span class="fl">0.20</span>), <span class="at">digits =</span> <span class="dv">4</span>, <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co"># Pooled CV = 0.2322 with 37 degrees of freedom</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co"># Upper 80% confidence limit of CV = 0.2603</span></span></code></pre></div>
<p>Before pooling, variances are weighted by the degrees of freedom.
Hence, the new estimate is with ~0.23 closer to the 0.25 of the larger
study. Note also that the upper confidence limit is with ~0.26 higher
than the one of the pilot study with ~0.24.</p>
<h2>
Caveats
</h2>
<p>Don’t pool data blindly. In the ideal situation you know the entire
background of all studies (clinical performance, bioanalytics). Even if
all studies were performed at the same <span title="Contract Research Organization">CRO</span>, more things are
important. One purpose of a pilot study is to find a suitable sampling
schedule. If the sampling schedule of the pilot was not ideal
(<em>e.g.</em>, <em>C</em><sub>max</sub> was not sufficiently enough
described), pooling is not a good idea. It might well be that in the
pivotal study – with a ‘better’ sampling schedule – its <em>CV</em> is
more reliable. On the other hand, <em>AUC</em> is less sensitive to
different sampling schedules.</p>
<p>Pooling data from the literature should be done with great caution
(if at all). Possibly critical information is missing. Consider using a
<em>CV</em> from the upper end of values instead. Common sense
helps.</p>
<p>An example where pooling could be misleading:
<em>C</em><sub>max</sub> data of pilot and pivotal studies in five
different designs with 11 to 39 subjects, fasting/fed, three different
bioanalytical methods (<span title="Gas Chromatography">GC</span>/<span title="Electron Capture Detection">ECD</span>, <span title="Liquid Chromatography">LC</span>-<span title="Tandem Mass Spectrometry">MS/MS</span>, <span title="Gas Chromatography">GC</span>/<span title="Mass Spectrometry">MS</span>), chiral and achiral (which is not
relevant for this drug since the active enantiomer is ~95% of the total
drug and there is no <em>in vivo</em> interconversion). Note that most
pivotal studies were ‘overpowered’.</p>
<div class="float">
<img src="data:image/png;base64,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" width="407" alt="Fig. 4 Blue deltoid pooled CV 0.163; dotted line its upper CL 0.167." />
<div class="figcaption"><strong>Fig. 4</strong> Blue deltoid pooled
<em>CV</em> 0.163; dotted line its upper <span title="Confidence Limit">CL</span> 0.167.</div>
</div>
<p>This is an apples-and-oranges comparison. Red squares show
<em>CV</em>s which were above the upper <span title="Confidence Limit">CL</span> of the pooled <em>CV</em>. Given,
only in two studies (#1, #6) their lower <span title="Confidence Limit">CL</span> did not overlap the upper one of the
pooled <em>CV</em>.</p>
<blockquote>
Which side of the great divide are you on? Do you believe that meta is
better or do you hold instead that pooling is fooling? Well, to nail my
colours to the mast, I belong to the former school. It seems to me that
there is no other topic in medical statistics, with the possible
exceptions of cross-over trials, bioequivalence and n-of-1 studies,
which has the same capacity as this one to rot the brains.
<footer>
— Stephen Senn (2020)<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>
</footer>
</blockquote>
</div>
<div id="hints" class="section level1">
<h1>Hints</h1>
<div id="power-analysis" class="section level2">
<h2>Power Analysis</h2>
<p>Although we suggest to explore the various options shown in <a href="#expl3">Example 3</a>, it is worthwhile to have a first look with
the function <code>pa.ABE()</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">pa.ABE</span>(<span class="at">CV =</span> <span class="fl">0.20</span>, <span class="at">theta0 =</span> <span class="fl">0.92</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a><span class="co"># Sample size plan ABE</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co">#  Design alpha  CV theta0 theta1 theta2 Sample size Achieved power</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="co">#     2x2  0.05 0.2   0.92    0.8   1.25          28       0.822742</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="co"># Power analysis</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="co"># CV, theta0 and number of subjects leading to min. acceptable power of ~0.7:</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="co">#  CV= 0.2377, theta0= 0.9001</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="co">#  n = 21 (power= 0.7104)</span></span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" height="626" alt="Fig. 5 Power Analysis (in each panel one argument is varied and others kept constant)" />
<div class="figcaption"><strong>Fig. 5</strong> Power Analysis (in each
panel one argument is varied and others kept constant)</div>
</div>
<p>This exercise confirms what we already know. The most critical
parameter is <span class="math inline">\(\small{\theta_0}\)</span>,
whereas dropouts are the least important.</p>
<p>More details are given in the vignette <a href="PA.html">Power
Analysis</a>.</p>
</div>
<div id="dropouts" class="section level2">
<h2>Dropouts</h2>
<p>As we have seen, the impact of dropouts on power is rather limited.
Regularly <span title="Contract Research Organizations">CROs</span>
suggest additional subjects to ‘compensate for the potential loss in
power’. IMHO, milking sponsors to make wealthy <span title="Contract Research Organizations">CROs</span> richer. Note that
the dropout-rate is based on <em>dosed</em> subjects. Hence, the correct
formula for the adjusted sample size <span class="math inline">\(\small{n{}&#39;}\)</span> based on the estimated
one <span class="math inline">\(\small{n}\)</span> is <span class="math inline">\(\small{n{}&#39;=n / (1-{dropout\:rate})}\)</span>,
and <u>not</u> <span class="math inline">\(\small{n{}&#39;=n \times
(1+{dropout\:rate})}\)</span>. An example for studies with three
periods:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>balance <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>  <span class="fu">return</span>(y <span class="sc">*</span> (x <span class="sc">%/%</span> y <span class="sc">+</span> <span class="fu">as.logical</span>(x <span class="sc">%%</span> y)))</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>}</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>do        <span class="ot">&lt;-</span> <span class="fl">0.15</span> <span class="co"># anticipated dropout-rate 15%</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>seqs      <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>n         <span class="ot">&lt;-</span> <span class="fu">seq</span>(12L, 96L, 12L)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>res       <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n =</span> n,</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>                        <span class="at">adj1 =</span> <span class="fu">balance</span>(n <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> do), seqs), <span class="co"># correct</span></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>                        <span class="at">elig1 =</span> <span class="cn">NA_integer_</span>, <span class="at">diff1 =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>                        <span class="at">adj2 =</span> <span class="fu">balance</span>(n <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> do), seqs), <span class="co"># wrong</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>                        <span class="at">elig2 =</span> <span class="cn">NA_integer_</span>, <span class="at">diff2 =</span> <span class="cn">NA_integer_</span>)</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>res<span class="sc">$</span>elig1 <span class="ot">&lt;-</span> <span class="fu">floor</span>(res<span class="sc">$</span>adj1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> do))</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a>res<span class="sc">$</span>diff1 <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%+i&quot;</span>, res<span class="sc">$</span>elig1 <span class="sc">-</span> n)</span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>res<span class="sc">$</span>elig2 <span class="ot">&lt;-</span> <span class="fu">floor</span>(res<span class="sc">$</span>adj2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> do))</span>
<span id="cb32-15"><a href="#cb32-15" tabindex="-1"></a>res<span class="sc">$</span>diff2 <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%+i&quot;</span>, res<span class="sc">$</span>elig2 <span class="sc">-</span> n)</span>
<span id="cb32-16"><a href="#cb32-16" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb32-17"><a href="#cb32-17" tabindex="-1"></a>  <span class="fu">ifelse</span>(res<span class="sc">$</span>elig1 <span class="sc">-</span> n <span class="sc">&gt;=</span><span class="dv">0</span>,</span>
<span id="cb32-18"><a href="#cb32-18" tabindex="-1"></a>         res<span class="sc">$</span>optim <span class="ot">&lt;-</span> res<span class="sc">$</span>elig1,</span>
<span id="cb32-19"><a href="#cb32-19" tabindex="-1"></a>         res<span class="sc">$</span>optim <span class="ot">&lt;-</span> res<span class="sc">$</span>elig2))</span>
<span id="cb32-20"><a href="#cb32-20" tabindex="-1"></a>res<span class="sc">$</span>diff  <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%+i&quot;</span>, res<span class="sc">$</span>optim <span class="sc">-</span> n)</span>
<span id="cb32-21"><a href="#cb32-21" tabindex="-1"></a><span class="fu">names</span>(res)[<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n&#39;1&quot;</span>, <span class="st">&quot;n&#39;2&quot;</span>)</span>
<span id="cb32-22"><a href="#cb32-22" tabindex="-1"></a>res<span class="sc">$</span>diff1[<span class="fu">which</span>(res<span class="sc">$</span>diff1 <span class="sc">==</span> <span class="st">&quot;+0&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;\u00B10&quot;</span></span>
<span id="cb32-23"><a href="#cb32-23" tabindex="-1"></a>res<span class="sc">$</span>diff2[<span class="fu">which</span>(res<span class="sc">$</span>diff2 <span class="sc">==</span> <span class="st">&quot;+0&quot;</span>)] <span class="ot">&lt;-</span> <span class="st">&quot;\u00B10&quot;</span></span>
<span id="cb32-24"><a href="#cb32-24" tabindex="-1"></a>res<span class="sc">$</span>diff[<span class="fu">which</span>(res<span class="sc">$</span>diff <span class="sc">==</span> <span class="st">&quot;+0&quot;</span>)]   <span class="ot">&lt;-</span> <span class="st">&quot;\u00B10&quot;</span></span>
<span id="cb32-25"><a href="#cb32-25" tabindex="-1"></a><span class="fu">print</span>(res, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb32-26"><a href="#cb32-26" tabindex="-1"></a><span class="co">#   n n&#39;1 elig1 diff1 n&#39;2 elig2 diff2 optim diff</span></span>
<span id="cb32-27"><a href="#cb32-27" tabindex="-1"></a><span class="co">#  12  15    12    ±0  15    12    ±0    12   ±0</span></span>
<span id="cb32-28"><a href="#cb32-28" tabindex="-1"></a><span class="co">#  24  30    25    +1  30    25    +1    25   +1</span></span>
<span id="cb32-29"><a href="#cb32-29" tabindex="-1"></a><span class="co">#  36  45    38    +2  42    35    -1    38   +2</span></span>
<span id="cb32-30"><a href="#cb32-30" tabindex="-1"></a><span class="co">#  48  57    48    ±0  57    48    ±0    48   ±0</span></span>
<span id="cb32-31"><a href="#cb32-31" tabindex="-1"></a><span class="co">#  60  72    61    +1  69    58    -2    61   +1</span></span>
<span id="cb32-32"><a href="#cb32-32" tabindex="-1"></a><span class="co">#  72  87    73    +1  84    71    -1    73   +1</span></span>
<span id="cb32-33"><a href="#cb32-33" tabindex="-1"></a><span class="co">#  84  99    84    ±0  99    84    ±0    84   ±0</span></span>
<span id="cb32-34"><a href="#cb32-34" tabindex="-1"></a><span class="co">#  96 114    96    ±0 111    94    -2    96   ±0</span></span></code></pre></div>
<p>With the wrong formula – especially for high dropout rates – you
might end up with less eligible subjects (<code>elig2</code>) than
planned thus compromising power. On the other hand, with the correct one
(due to rounding up to get balanced sequences) you might end up with
slightly too many (<code>elig1</code>). Of course, if you want to be one
the safe side, you can select the ‘best’ (column
<code>optim</code>).</p>
</div>
<div id="literature-data" class="section level2">
<h2>Literature Data</h2>
<p>Sometimes the <em>CV</em> is not given in the literature. By means of
the function <code>CVfromCI()</code> we can calculate it from the
confidence interval, the design, and the sample size.<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">CVfromCI</span>(<span class="at">lower =</span> <span class="fl">0.8323</span>, <span class="at">upper =</span> <span class="fl">1.0392</span>, <span class="at">design =</span> <span class="st">&quot;2x2x4&quot;</span>, <span class="at">n =</span> <span class="dv">26</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="co"># [1] 0.3498608</span></span></code></pre></div>
<p>The method is exact if the subjects/sequence are known. In the
literature quite often only the total sample size is given and the
function tries to keep sequences as balanced as possible. What if the
study was imbalanced?<br />
A total sample size of 26 was reported. The study was either balanced or
imbalanced to an unknown degree:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>n      <span class="ot">&lt;-</span> <span class="dv">26</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>CV.est <span class="ot">&lt;-</span> <span class="fu">CVfromCI</span>(<span class="at">lower =</span> <span class="fl">0.8323</span>, <span class="at">upper =</span> <span class="fl">1.0392</span>,</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>                   <span class="at">design =</span> <span class="st">&quot;2x2x4&quot;</span>, <span class="at">n =</span> <span class="dv">26</span>)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>n.est  <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV.est, <span class="at">design =</span> <span class="st">&quot;2x2x4&quot;</span>,</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>                       <span class="at">print =</span> <span class="cn">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>n1     <span class="ot">&lt;-</span> <span class="fu">balance</span>(<span class="fu">seq</span>(n, <span class="dv">18</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="dv">2</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>n2     <span class="ot">&lt;-</span> n <span class="sc">-</span> n1</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>nseqs  <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">data.frame</span>(<span class="at">n1 =</span> n1, <span class="at">n2 =</span> n2, <span class="at">n =</span> n))</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>res    <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n1 =</span> nseqs<span class="sc">$</span>n1, <span class="at">n2 =</span> nseqs<span class="sc">$</span>n2,</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>                     <span class="at">CV.true =</span> <span class="cn">NA_real_</span>,</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>                     <span class="at">CV.est =</span> CV.est, <span class="at">n.true =</span> <span class="cn">NA_integer_</span>,</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>                     <span class="at">n.est =</span> n.est)</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(res)) {</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>  res<span class="sc">$</span>CV.true[i] <span class="ot">&lt;-</span> <span class="fu">CVfromCI</span>(<span class="at">lower =</span> <span class="fl">0.8323</span>, <span class="at">upper =</span> <span class="fl">1.0392</span>,</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>                             <span class="at">design =</span> <span class="st">&quot;2x2x4&quot;</span>,</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>                             <span class="at">n =</span> <span class="fu">c</span>(res<span class="sc">$</span>n1[i], res<span class="sc">$</span>n2[i]))</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>  res<span class="sc">$</span>n.true[i]  <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> res<span class="sc">$</span>CV.true[i], <span class="at">design =</span> <span class="st">&quot;2x2x4&quot;</span>,</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>                                 <span class="at">print =</span> <span class="cn">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  res<span class="sc">$</span>n.est[i]   <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV.est, <span class="at">design =</span> <span class="st">&quot;2x2x4&quot;</span>,</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>                                 <span class="at">print =</span> <span class="cn">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>}</span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">signif</span>(res, <span class="dv">5</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a><span class="co">#  n1 n2 CV.true  CV.est n.true n.est</span></span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="co">#  13 13 0.34986 0.34986     26    26</span></span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a><span class="co">#  12 14 0.34876 0.34986     26    26</span></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="co">#  11 15 0.34546 0.34986     26    26</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a><span class="co">#  10 16 0.33988 0.34986     24    26</span></span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a><span class="co">#   9 17 0.33196 0.34986     24    26</span></span></code></pre></div>
<p>The true <em>CV</em> of any imbalanced study might have been lower
than what we assumed. That means, if we use the estimated <em>CV</em> –
falsely assuming balanced sequences – our sample size estimation will
always be conservative.</p>
</div>
<div id="direction-of-deviation" class="section level2">
<h2>Direction of Deviation</h2>
<p>If you are unsure about the direction of the deviation of T from R
(lower or higher) always assume <span class="math inline">\(\small{\theta_0&lt;1}\)</span>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>CV   <span class="ot">&lt;-</span> <span class="fl">0.21</span></span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>d    <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># delta 5%, direction unknown</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>n    <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV, <span class="at">theta0 =</span> <span class="dv">1</span> <span class="sc">-</span> d, <span class="at">print =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>                     <span class="at">details =</span> <span class="cn">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CV =</span> CV, <span class="at">theta0 =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">-</span> d, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> d)),</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>                   <span class="at">n =</span> n, <span class="at">power =</span> <span class="cn">NA_real_</span>)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(res1)) {</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  res1<span class="sc">$</span>power[i] <span class="ot">&lt;-</span> <span class="fu">power.TOST</span>(<span class="at">CV =</span> CV, <span class="at">theta0 =</span> res1<span class="sc">$</span>theta0[i], <span class="at">n =</span> n)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>}</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>n    <span class="ot">&lt;-</span> <span class="fu">sampleN.TOST</span>(<span class="at">CV =</span> CV, <span class="at">theta0 =</span> <span class="dv">1</span> <span class="sc">+</span> d,</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>                     <span class="at">print =</span> <span class="cn">FALSE</span>)[[<span class="st">&quot;Sample size&quot;</span>]]</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">CV =</span> CV, <span class="at">theta0 =</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">+</span> d, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> d)),</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>                   <span class="at">n =</span> n, <span class="at">power =</span> <span class="cn">NA_real_</span>)</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(res1)) {</span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>  res2<span class="sc">$</span>power[i] <span class="ot">&lt;-</span> <span class="fu">power.TOST</span>(<span class="at">CV =</span> CV, <span class="at">theta0 =</span> res2<span class="sc">$</span>theta0[i], <span class="at">n =</span> n)</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>}</span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbind</span>(res1, res2)</span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">signif</span>(res[<span class="fu">order</span>(res<span class="sc">$</span>n, res<span class="sc">$</span>theta0), ], <span class="dv">4</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a><span class="co">#    CV theta0  n  power</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a><span class="co">#  0.21 0.9524 20 0.8081</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a><span class="co">#  0.21 1.0500 20 0.8081</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a><span class="co">#  0.21 0.9500 22 0.8374</span></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a><span class="co">#  0.21 1.0530 22 0.8374</span></span></code></pre></div>
<p>If you use 1.05 (sample size 20) power will be maintained all the way
down to its reciprocal (0.9524) but <em>not</em> to 0.95 (where you
would already need a sample size of 22). On the other hand, 0.95
preserves power up to 1.053. The statement ‘sample size based on a
deviation of ±5%’ seen in many protocol does not make sense.</p>
</div>
</div>
<div id="authors" class="section level1">
<h1>Authors</h1>
<table>
<colgroup>
<col width="63%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th>function</th>
<th>author(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sampleN.TOST</code>, <code>power.TOST</code>,
<code>power.TOST.sds</code>,
<code>sampleN.RatioF</code>,<br /><code>CVCL</code>, <code>CI.BE</code>,
<code>CVpooled</code></td>
<td>Detlew Labes</td>
</tr>
<tr class="even">
<td><code>expsampleN.TOST</code></td>
<td><span style="white-space:nowrap">Benjamin Lang, Detlew
Labes</span></td>
</tr>
<tr class="odd">
<td><code>CVfromCI</code></td>
<td><span style="white-space:nowrap">Detlew Labes, Helmut Schütz,
Benjamin Lang</span></td>
</tr>
<tr class="even">
<td><code>pa.ABE</code></td>
<td><span style="white-space:nowrap">Helmut Schütz, Detlew
Labes</span></td>
</tr>
</tbody>
</table>
</div>
<div id="license" class="section level1">
<h1>License</h1>
<h4 class="author">
<a href="https://cran.r-project.org/web/licenses/GPL-3" title="GNU General Public License, Version 3">GPL-3</a> 2024-03-18
Helmut Schütz
</h4>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>It is common a misconception that in a parallel design
one obtains the <em>between</em>- (inter-) subject variability. The fact
that products are administered only once does not mean that the
within-subject variability does not exist (we <em>observed</em> only one
occasion). Hence, the variability consists of both <em>between</em>- and
<em>within</em>-components. We can estimate the between-subject
variability <em>only</em> in a crossover design. Referring to
between-subject variability in a parallel design is sloppy terminology
at least.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Owen DB. <em>A special case of a bivariate non-central
t-distribution.</em> Biometrika. 1965: 52(3/4); 437–46. <a href="https://doi.org/10.2307/2333696">doi:10.2307/2333696</a>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>R Documentation. <em>R-manual. Data Frames.</em>
2022-02-08. <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/data.frame.html">Online</a>.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>In other functions of <code>PowerTOST</code> the sample
size is not given in the seventh column but always named
<code>&quot;Sample size&quot;</code>.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Schütz H. <em>Multi-Group Studies in Bioequivalence. To
pool or not to pool? Review of Guidelines.</em> BioBridges. Prague,
26–27 September, 2018. <a href="https://bebac.at/lectures/Prague2018.pdf#page=7">Online</a>.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Fieller EC. <em>Some Problems In Interval
Estimation.</em> J Royal Stat Soc B. 1954; 16(2): 175–85. <a href="https://www.jstor.org/stable/2984043">JSTOR:2984043</a>.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>EMEA, CPMP. <em>Points to Consider on Switching between
Superiority and Non-Inferiority.</em> London. 27 July 2000.
CPMP/EWP/482/99. <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/points-consider-switching-between-superiority-and-non-inferiority_en.pdf">Online</a>.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>Gould AL. <em>Group Sequential Extension of a Standard
Bioequivalence Testing Procedure.</em> J Pharmacokin Biopharm. 1995:
23(1); 57–86. <a href="https://doi.org/10.1007/BF02353786">doi:10.1007/BF02353786</a>.<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>Dubins D. <em>My Tiny Contribution to Clinical Research:
FARTSSIE.</em> 2021-03-21. <a href="https://github.com/dndubins/FARTSSIE">GitHub</a>.<a href="#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>Labes D, Lang B, Schütz H. <em>Power2Stage: Power and
Sample-Size Distribution of 2-Stage Bioequivalence Studies.</em>
2021-11-20. <a href="https://cran.r-project.org/package=Power2Stage">CRAN</a>.<a href="#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>Ring A, Lang B, Kazaroho C, Labes D, Schall R, Schütz
H. <em>Sample size determination in bioequivalence studies using
statistical assurance.</em> Br J Clin Pharmacol. 2019; 85(10): 2369–77.
<a href="https://doi.org/10.1111/bcp.14055">doi:10.1111/bcp.14055</a>.
<a href="https://bpspubs.onlinelibrary.wiley.com/doi/epdf/10.1111/bcp.14055">Open
access</a>.<a href="#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>Schuirmann DJ. <em>Two at a Time? Or All at Once?</em>
International Biometric Society, Eastern North American Region, Spring
Meeting. Pittsburgh, PA. March 28 – 31, 2004. <a href="https://www.enar.org/meetings/meetings2004/enar_final_program_2004.pdf#page=204">Online
abstract</a>.<a href="#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>EMA, CHMP. <em>Guideline on the Investigation of
Bioequivalence.</em> London. 20 January 2010. CPMP/EWP/QWP/1401/98
Rev. 1/ Corr **. <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf#page=14">Online</a>.<a href="#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>EGA. <em>Revised EMA Bioequivalence Guideline.
Questions &amp; Answers.</em> <a href="https://www.medicinesforeurope.com/wp-content/uploads/2016/03/EGA_BEQ_QA_WEB_QA_1_32.pdf#page=20">Online</a>.<a href="#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>D’Angelo P. <em>Testing for Bioequivalence in
Higher‐Order Crossover Designs: Two‐at‐a‐Time Principle Versus Pooled
ANOVA.</em> 2<sup>nd</sup> Conference of the Global Bioequivalence
Harmonisation Initiative. Rockville, MD. 15–16 September, 2016.<a href="#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Schuirmann DJ. <em>A Comparison of the Two One-Sided
Tests Procedure and the Power Approach for Assessing the Equivalence of
Average Bioavailability.</em> J Pharmacokin Biopharm. 1987; 15(6):
657–80. <a href="https://doi.org/10.1007/BF01068419">doi:10.1007/BF01068419</a>.<a href="#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>If the <span title="Confidence Interval">CI</span>
overlaps <span class="math inline">\(\small{\{\theta_1,\theta_2\}}\)</span>, the
outcome is indecisive (called ‘the gray zone’ by some). As long as <span class="math inline">\(\small{\theta_0}\)</span> lies within <span class="math inline">\(\small{\{\theta_1,\theta_2\}}\)</span> you can
hope to show BE in a larger sample size. However, once <span class="math inline">\(\small{\theta_0}\)</span> approaches one of the
limits, if might be futile – even with a very small <em>CV</em>.
Try<br />
  <code>sampleN.TOST(CV = 0.075, theta0 = 0.81)</code> and then<br />
  <code>sampleN.TOST(CV = 0.075, theta0 = 0.80)</code> to get an idea.<a href="#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>Hoenig JM, Heisey DM. <em>The Abuse of Power: The
Pervasive Fallacy of Power Calculations for Data Analysis.</em> Am Stat.
2001; 55(1): 19–24. <a href="https://www.vims.edu/people/hoenig_jm/pubs/hoenig2.pdf">Open
access</a>.<a href="#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Lenth RA. <em>Two Sample-Size Practices that I Don’t
Recommend.</em> <a href="http://homepage.divms.uiowa.edu/~rlenth/Power/2badHabits.pdf">Online</a>.<a href="#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>Senn S. <em>A Dip in the Pool.</em> 2020-05-03. <a href="http://www.senns.uk/wprose.html#Pool">Online</a>.<a href="#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>Schütz H. <em>Sample Size Estimation for BE Studies:
Algebra…</em> Bucharest. 19 March 2013. <a href="https://bebac.at/lectures/Bucharest2013WS1.pdf#page=26">Online</a><a href="#fnref21" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
