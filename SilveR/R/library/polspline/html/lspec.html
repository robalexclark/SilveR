<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Lspec: logspline estimation of a spectral distribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for lspec {polspline}"><tr><td>lspec {polspline}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Lspec: logspline estimation of a spectral distribution</h2>

<h3>Description</h3>

<p> Fit an <code>lspec</code> model
to a time-series or a periodogram.</p>


<h3>Usage</h3>

<pre>lspec(data, period, penalty, minmass, knots, maxknots, atoms, maxatoms,
maxdim , odd = FALSE, updown = 3, silent = TRUE) </pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>

<p>time series (exactly one of <code>data</code> and <code>period</code> should be specified). 
If <code>data</code> is specified, <code>lspec</code> first computes the modulus 
of the fast Fourier transform 
of the series using the function
<code><a href="../../stats/html/fft.html">fft</a></code>, resulting in a periodogram of length
<code>floor(length(data)/2)</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>period</code></td>
<td>

<p>value of the periodogram for a time series at frequencies 
<i>2pi*j/T</i>, for <i>1&lt;=j&lt;=T/2</i>. If period is specified, odd should indicate 
whether the length of the series T is odd <code>(odd = TRUE)</code> or even <code>(odd = FALSE)</code>. 
Exactly one of <code>data</code> and <code>period</code> should be specified. 
</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>

<p>the parameter to be used in the AIC criterion. The method chooses 
the number of basis 
functions that minimizes <code>-2 * loglikelihood + penalty * (number of basis 
functions)</code>. 
Default is to use a penalty parameter of <code>penalty = log(length(period))</code> as in BIC.  </p>
</td></tr>
<tr valign="top"><td><code>minmass</code></td>
<td>

<p>threshold value for atoms. No atoms having smaller mass than <code>minmass</code> are 
included in the model. If <code>minmass</code> takes its default value, in 
95% of the samples, when data is Gaussian white noise, the model will not 
contain atoms.  </p>
</td></tr>
<tr valign="top"><td><code>knots</code></td>
<td>

<p>ordered vector of values, which forces the method to start with these knots. 
If <code>knots</code> is not specified, the program starts with one knot at zero and then 
employs stepwise addition of knots and atoms. 
</p>
</td></tr>
<tr valign="top"><td><code>maxknots</code></td>
<td>
<p> maximum number of knots allowed in the model. Does not need to be 
specified, since the program has a default for <code>maxdim</code> and 
the number of dimensions equals the number of knots plus the number of 
atoms. If <code>maxknots = 1</code> the fitted spectral density function is 
constant. 
</p>
</td></tr>
<tr valign="top"><td><code>atoms</code></td>
<td>

<p>ordered vector of values, which forces the method to start with discrete 
components at these frequencies. The values of atoms are rounded 
to the nearest multiple of <i>2*pi/T</i>. 
If atoms is not specified, the program starts with no atoms and then performs 
stepwise addition of knots and atoms. 
</p>
</td></tr>
<tr valign="top"><td><code>maxatoms</code></td>
<td>

<p>maximum number of discrete components allowed in the model. Does not need to be 
specified, since the program has a default for <code>maxdim</code> and 
the number of dimensions equals the number of knots plus the number of 
atoms. If <code>maxatoms = 0</code> a continuous 
spectral distribution is fit. 
</p>
</td></tr>
<tr valign="top"><td><code>maxdim</code></td>
<td>

<p>maximum number of basis 
functions allowed in the model (default is 
<i>max(15,4*length(period)^0.2)</i>). 
</p>
</td></tr>
<tr valign="top"><td><code>odd</code></td>
<td>

<p>see <code>period</code>. If <code>period</code> is not specified, <code>odd</code> is not relevant. 
</p>
</td></tr>
<tr valign="top"><td><code>updown</code></td>
<td>

<p>the maximal number of times that <code>lspec</code> should go through a cycle of stepwise 
addition and stepwise deletion until a stable solution is reached. 
</p>
</td></tr>
<tr valign="top"><td><code>silent</code></td>
<td>

<p>should printing of information be suppressed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>lspec</code>.
The output is organized to serve as input for <code><a href="../../polspline/help/plot.lspec.html">plot.lspec</a></code>
(summary plots),
<code><a href="../../polspline/help/summary.lspec.html">summary.lspec</a></code> (summarizes fitting), <code><a href="../../polspline/help/clspec.html">clspec</a></code> (for
autocorrelations and autocovariances), <code><a href="../../polspline/help/dlspec.html">dlspec</a></code> (for spectral density and line-spectrum,) 
<code><a href="../../polspline/help/plspec.html">plspec</a></code> (for the spectral distribution), and <code><a href="../../polspline/help/rlspec.html">rlspec</a></code>
(for random time series with the same spectrum).
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>call</code></td>
<td>

<p>the command that was executed. 
</p>
</td></tr>
<tr valign="top"><td><code>thetap</code></td>
<td>

<p>coefficients of the polynomial part of the spline. 
</p>
</td></tr>
<tr valign="top"><td><code>nknots</code></td>
<td>

<p>the number of knots that were retained. 
</p>
</td></tr>
<tr valign="top"><td><code>knots</code></td>
<td>

<p>vector of the locations of the knots in the logspline model. 
Only the knots that were retained are in this vector.  
</p>
</td></tr>
<tr valign="top"><td><code>thetak</code></td>
<td>

<p>coefficients of the knot part of the 
spline. The k-th coefficient is the coefficient 
of  <i>(x-t(k))^3_+</i>. 
</p>
</td></tr>
<tr valign="top"><td><code>natoms</code></td>
<td>

<p>the number of atoms that were retained. 
</p>
</td></tr>
<tr valign="top"><td><code>atoms</code></td>
<td>

<p>vector of the locations of the atoms in the model. 
Only the atoms that were retained are in this vector.  
</p>
</td></tr>
<tr valign="top"><td><code>mass</code></td>
<td>

<p>The k-th coefficient is the mass at <code>atom[k]</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>logl</code></td>
<td>

<p>the log-likelihood of the model. 
</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>

<p>the penalty that was used. 
</p>
</td></tr>
<tr valign="top"><td><code>minmass</code></td>
<td>

<p>the minimum mass for an atom that was allowed. 
</p>
</td></tr>
<tr valign="top"><td><code>sample</code></td>
<td>

<p>the sample size that was used, either computed as <code>length(data)</code> or 
as <code>(2 * length(period))</code>  when <code>odd = FALSE</code> or as
<code>(2 * length(period) + 1)</code>  when <code>odd = TRUE</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>updown</code></td>
<td>

<p>the actual number of times that <code>lspec</code> went through a cycle of  
stepwise addition and stepwise  deletion  
until a stable solution was reached, or 
minus the number of times that lspec went through a cycle of  
stepwise addition and stepwise  deletion until it decided to quit. 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg, Charles J. Stone, and Young K. Truong (1995).
Logspline Estimation of a Possibly Mixed Spectral Distribution.
<em>Journal of Time Series Analysis</em>, <b>16</b>, 359-388.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

<p><code><a href="../../polspline/help/plot.lspec.html">plot.lspec</a></code>, <code><a href="../../polspline/help/summary.lspec.html">summary.lspec</a></code>, <code><a href="../../polspline/help/clspec.html">clspec</a></code>, <code><a href="../../polspline/help/dlspec.html">dlspec</a></code>,
<code><a href="../../polspline/help/plspec.html">plspec</a></code>, <code><a href="../../polspline/help/rlspec.html">rlspec</a></code>.</p>


<h3>Examples</h3>

<pre>
data(co2)
co2.detrend &lt;- unstrip(lm(co2~c(1:length(co2)))$residuals)
fit &lt;- lspec(co2.detrend)
</pre>

<hr /><div style="text-align: center;">[Package <em>polspline</em> version 1.1.20 <a href="00Index.html">Index</a>]</div>
</div></body></html>
