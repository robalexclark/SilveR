<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Heft: hazard estimation with flexible tails</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for heft {polspline}"><tr><td>heft {polspline}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Heft: hazard estimation with flexible tails</h2>

<h3>Description</h3>

<p>Hazard estimation using cubic splines to 
approximate the log-hazard function and special functions to allow
non-polynomial shapes in both tails. 
</p>


<h3>Usage</h3>

<pre>heft(data, delta, penalty, knots, leftlin, shift, leftlog,
rightlog, maxknots, mindist, silent = TRUE) </pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>data</code></td>
<td>

<p>vector of observations. Observations may or may not be right censored. All
observations should be nonnegative.
</p>
</td></tr>
<tr valign="top"><td><code>delta</code></td>
<td>

<p>binary vector with the same length as <code>data</code>. Elements of <code>data</code>
for which the corresponding element of <code>delta</code> is 0 are assumed to be
right censored, elements of <code>data</code>
for which the corresponding element of <code>delta</code> is 1 are assumed to be
uncensored. If <code>delta</code> is missing, all observations are assumed to be uncensored.
</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>

<p>the parameter to be used in the AIC criterion. The method chooses
the number of knots that minimizes <code>-2 * loglikelihood + penalty * (dimension)</code>.
The default is to use <code>penalty = log(samplesize)</code> as in BIC. The effect of
this parameter is summarized in <code><a href="../../polspline/help/summary.heft.html">summary.heft</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>knots</code></td>
<td>

<p>ordered vector of values, which forces the method to start with these knots. 
If <code>knots</code> is not specified, a default knot-placement rule is employed. 
</p>
</td></tr>
<tr valign="top"><td><code>leftlin</code></td>
<td>

<p>if <code>leftlin</code> is <code>TRUE</code> an extra basis-function, which is linear to the left 
of the first knot, is included in the basis. 
If any of <code>data</code> is exactly 0, the default of <code>leftlin</code> is <code>TRUE</code>,
otherwise it is <code>FALSE</code>.
</p>
</td></tr>
<tr valign="top"><td><code>shift</code></td>
<td>

<p>parameter for the log terms. Default is <code>quantile(data[delta == 1], .75)</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>leftlog</code></td>
<td>

<p>coefficient of <i>\code{log(x/(x+shift))}</i>, which must be greater than 
<code>-1</code>. 
(In particular, if <code>leftlog</code> equals zero no 
<i>\code{log(x/(x+shift))}</i> term 
is included.) If <code>leftlog</code> is missing its maximum likelihood estimate is used. 
If any of <code>data</code> is exactly zero, <code>leftlog</code> is  
set to zero. 
</p>
</td></tr>
<tr valign="top"><td><code>rightlog</code></td>
<td>

<p>coefficient of <i>\code{log(x+shift)}</i>, which must be greater than 
<code>-1</code>.
(In particular, if <code>leftlog</code> equals zero no  
<i>\code{log(x+shift)}</i> term
is included.)
If <code>rightlog</code> is missing its maximum likelihood estimate is used. 
</p>
</td></tr>
<tr valign="top"><td><code>maxknots</code></td>
<td>

<p>maximum number of knots allowed in the model (default is 
<i>\code{4 * n^0.2}</i>, where <i>n</i> is the length of
<code>data</code>.
</p>
</td></tr>
<tr valign="top"><td><code>mindist</code></td>
<td>
<p> minimum distance in order statistics between knots. The
default is 5.  </p>
</td></tr>
<tr valign="top"><td><code>silent</code></td>
<td>

<p>suppresses the printing of diagnostic output about knots added or deleted, 
Rao-statistics, Wald-statistics and log-likelihoods. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class
<code>heft</code>, which is organized to serve as input for <code><a href="../../polspline/help/plot.heft.html">plot.heft</a></code>,
<code><a href="../../polspline/help/summary.heft.html">summary.heft</a></code>, <code><a href="../../polspline/help/dheft.html">dheft</a></code> (density), <code><a href="../../polspline/help/hheft.html">hheft</a></code>
(hazard rate), <code><a href="../../polspline/help/pheft.html">pheft</a></code> (probabilities), <code><a href="../../polspline/help/qheft.html">qheft</a></code>
(quantiles), and <code><a href="../../polspline/help/rheft.html">rheft</a></code> (random numbers).
The object is a list with the following members:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>knots </code></td>
<td>

<p>vector of the locations of the knots in the <code>heft</code> model. 
</p>
</td></tr>
<tr valign="top"><td><code>logl</code></td>
<td>

<p>the <code>k</code>-th element is the log-likelihood of the fit with <code>k</code> knots. 
</p>
</td></tr>
<tr valign="top"><td><code>thetak</code></td>
<td>

<p>coefficients of the knot part of the 
spline. The k-th coefficient is the coefficient 
of  <i>(x-t(k))^3_+</i>. If a coefficient is zero the corresponding 
knot was considered and then deleted from the model. 
</p>
</td></tr>
<tr valign="top"><td><code>thetap</code></td>
<td>

<p>coefficients of the polynomial part of the spline. 
The first element is the constant term and 
the second element is the linear term. 
</p>
</td></tr>
<tr valign="top"><td><code>thetal</code></td>
<td>

<p>coefficients of the logarithmic terms. The first element equals 
<code>leftlog</code> and the second element equals <code>rightlog</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>penalty</code></td>
<td>

<p>the penalty that was used. 
</p>
</td></tr>
<tr valign="top"><td><code>shift</code></td>
<td>
<p> parameter used in the definition of the log terms.  </p>
</td></tr>
<tr valign="top"><td><code>sample</code></td>
<td>
<p> the sample size.  </p>
</td></tr>
<tr valign="top"><td><code>logse</code></td>
<td>
<p> the standard errors of <code>thetal</code>.  </p>
</td></tr>
<tr valign="top"><td><code>max</code></td>
<td>
<p> the largest element of data.  </p>
</td></tr>
<tr valign="top"><td><code>ad</code></td>
<td>
<p> vector indicating whether a model of this dimension 
was not fit (2), fit during the addition stage (0) or during 
the deletion stage (1).  </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg, Charles J. Stone and Young K. Truong (1995).
Hazard regression.  <em>Journal of the American Statistical
Association</em>, <b>90</b>, 78-94.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371&ndash;1470.</p>


<h3>See Also</h3>

<p><code><a href="../../polspline/help/hare.html">hare</a></code>,
<code><a href="../../polspline/help/plot.heft.html">plot.heft</a></code>,
<code><a href="../../polspline/help/summary.heft.html">summary.heft</a></code>,
<code><a href="../../polspline/help/dheft.html">dheft</a></code>,
<code><a href="../../polspline/help/hheft.html">hheft</a></code>,
<code><a href="../../polspline/help/pheft.html">pheft</a></code>,
<code><a href="../../polspline/help/qheft.html">qheft</a></code>,
<code><a href="../../polspline/help/rheft.html">rheft</a></code>.</p>


<h3>Examples</h3>

<pre>
fit1 &lt;- heft(testhare[,1], testhare[,2])
# modify tail behavior
fit2 &lt;- heft(testhare[,1], testhare[,2], leftlog = FALSE, rightlog = FALSE, 
          leftlin = TRUE)   
fit3 &lt;- heft(testhare[,1], testhare[,2], penalty = 0)   # select largest model
</pre>

<hr /><div style="text-align: center;">[Package <em>polspline</em> version 1.1.20 <a href="00Index.html">Index</a>]</div>
</div></body></html>
