<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Add a grouping factor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for add_grouping {emmeans}"><tr><td>add_grouping {emmeans}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Add a grouping factor</h2>

<h3>Description</h3>

<p>This function adds a grouping factor to an existing reference grid or other 
<code>emmGrid</code> object, such that the levels of an existing factor (call it the
reference factor) are mapped to a smaller number of levels of the new
grouping factor. The reference factor is then nested in the grouping factor. 
This facilitates obtaining marginal means of the grouping factor, and 
contrasts thereof.
</p>


<h3>Usage</h3>

<pre>
add_grouping(object, newname, refname, newlevs)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>An <code>emmGrid</code> object</p>
</td></tr>
<tr valign="top"><td><code>newname</code></td>
<td>
<p>Character name of grouping factor to add (different from any
existing factor in the grid)</p>
</td></tr>
<tr valign="top"><td><code>refname</code></td>
<td>
<p>Character name of the reference factor</p>
</td></tr>
<tr valign="top"><td><code>newlevs</code></td>
<td>
<p>Character vector or factor of the same length as that of the levels for 
<code>refname</code>. The grouping factor <code>newname</code> will have the unique
values of <code>newlevs</code> as its levels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A revised <code>emmGrid</code> object having an additional factor named 
<code>newname</code>, and a new nesting structure <code>refname %in% newname</code>
</p>


<h3>Note</h3>

<p>By default, the levels of <code>newname</code> will be ordered
alphabetically. To dictate a different ordering of levels, supply 
<code>newlevs</code> as a <code>factor</code> having its levels in the required order.
</p>


<h3>Examples</h3>

<pre>
fiber.lm &lt;- lm(strength ~ diameter + machine, data = fiber)
( frg &lt;- ref_grid(fiber.lm) )

# Suppose the machines are two different brands
brands &lt;- factor(c("FiberPro", "FiberPro", "Acme"), levels = c("FiberPro", "Acme"))
( gfrg &lt;- add_grouping(frg, "brand", "machine", brands) )

emmeans(gfrg, "machine")

emmeans(gfrg, "brand")
</pre>

<hr /><div style="text-align: center;">[Package <em>emmeans</em> version 1.4.5 <a href="00Index.html">Index</a>]</div>
</body></html>
