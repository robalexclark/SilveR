<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Calculate prediction areas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for background.predict {mixOmics}"><tr><td>background.predict {mixOmics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Calculate prediction areas</h2>

<h3>Description</h3>

<p>Calculate prediction areas that can be used in plotIndiv to shade the background.</p>


<h3>Usage</h3>

<pre>
background.predict (object, comp.predicted = 1, dist = "max.dist",
xlim = NULL, ylim = NULL, resolution = 100)

</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>A list of data sets (called 'blocks') measured on the same samples. Data in the list should be arranged in matrices, samples x variables, with samples order matching in all data sets.</p>
</td></tr>
<tr valign="top"><td><code>comp.predicted</code></td>
<td>
<p>Matrix response for a multivariate regression framework. Data should be continuous variables (see block.splsda for supervised classification and factor reponse)</p>
</td></tr>
<tr valign="top"><td><code>dist</code></td>
<td>
<p>distance to use to predict the class of new data,
should be a subset of <code>"centroids.dist"</code>, <code>"mahalanobis.dist"</code> or <code>"max.dist"</code> (see <code><a href="predict.html">predict</a></code>).</p>
</td></tr>
<tr valign="top"><td><code>xlim,ylim</code></td>
<td>
<p>numeric list of vectors of length 2, giving the x and y coordinates ranges for the simulated data. By default will be <i>1.2*</i> the range of object$variates$X[,i]</p>
</td></tr>
<tr valign="top"><td><code>resolution</code></td>
<td>
<p>A total of <code>resolution*resolution</code> data are simulated between xlim[1], xlim[2], ylim[1] and ylim[2].</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>background.predict</code> simulates <code>resolution*resolution</code> points within the rectangle defined by xlim on the x-axis and ylim on the y-axis, and then predicts the class of each point (defined by two coordinates). The algorithm estimates the predicted area for each class, defined as the 2D surface where all points are predicted to be of the same class. A polygon is returned and should be passed to <code><a href="plotIndiv.html">plotIndiv</a></code> for plotting the actual background.
</p>
<p>Note that by default xlim and ylim will create a rectangle of simulated data that will cover the plotted area of <code>plotIndiv</code>. However, if you use <code>plotIndiv</code> with <code>ellipse=TRUE</code> or if you set <code>xlim</code> and <code>ylim</code>, then you will need to adapt <code>xlim</code> and <code>ylim</code> in <code>background.predict</code>.
</p>
<p>Also note that the white frontier that defines the predicted areas when plotting with <code>plotIndiv</code> can be reduced by increasing <code>resolution</code>.
</p>
<p>More details about the prediction distances in <code>?predict</code> and the supplemental material of the mixOmics article (Rohart et al. 2017).
</p>


<h3>Value</h3>

<p><code>background.predict</code> returns a list of coordinates to be used with <code><a href="../../graphics/html/polygon.html">polygon</a></code> to draw the predicted area for each class.
</p>


<h3>Author(s)</h3>

<p>Florian Rohart</p>


<h3>References</h3>

<p>Rohart F, Gautier B, Singh A, LÃª Cao K-A. mixOmics: an R package for 'omics feature selection and multiple data integration. PLoS Comput Biol 13(11): e1005752
</p>


<h3>See Also</h3>

<p><code><a href="plotIndiv.html">plotIndiv</a></code>, <code><a href="predict.html">predict</a></code>, <code><a href="../../graphics/html/polygon.html">polygon</a></code>.</p>


<h3>Examples</h3>

<pre>

# Example 1
# -----------------------------------
data(breast.tumors)
X &lt;- breast.tumors$gene.exp
Y &lt;- breast.tumors$sample$treatment

splsda.breast &lt;- splsda(X, Y,keepX=c(10,10),ncomp=2)

# calculating background for the two first components, and the centroids distance

background = background.predict(splsda.breast, comp.predicted = 2, dist = "centroids.dist")

## Not run: 
# default option: note that the outcome color is included by default!
plotIndiv(splsda.breast, background = background, legend=TRUE)




# Example 2
# -----------------------------------
data(liver.toxicity)
X = liver.toxicity$gene
Y = as.factor(liver.toxicity$treatment[, 4])

plsda.liver &lt;- plsda(X, Y, ncomp = 2)

# calculating background for the two first components, and the mahalanobis distance
background = background.predict(plsda.liver, comp.predicted = 2, dist = "mahalanobis.dist")

plotIndiv(plsda.liver, background = background, legend = TRUE)



## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>mixOmics</em> version 6.10.8 <a href="00Index.html">Index</a>]</div>
</body></html>
