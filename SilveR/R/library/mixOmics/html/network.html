<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Relevance Network for (r)CCA and (s)PLS regression</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for network {mixOmics}"><tr><td>network {mixOmics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Relevance Network for (r)CCA and (s)PLS regression</h2>

<h3>Description</h3>

<p>Display relevance associations network for (regularized) canonical correlation analysis
and (sparse) PLS regression. The function avoids the intensive computation of Pearson correlation matrices on large data set by calculating instead a pair-wise similarity matrix directly obtained from the latent components of our integrative approaches (CCA, PLS, block.pls methods). The similarity value between a pair of variables is obtained by calculating the sum of the correlations between the original variables and each of the latent components of the model. The values in the similarity matrix can be seen as a robust approximation of the Pearson correlation (see González et al. 2012 for a mathematical demonstration and exact formula). The advantage of relevance networks is their ability to simultaneously represent positive and negative correlations, which are missed by methods based on Euclidean distances or mutual information. Those networks are bipartite and thus only a link between two variables of different types can be represented. The network can be saved in a .glm format using the <code>igraph</code> package, the function <code>write.graph</code> and extracting the output <code>object$gR</code>, see details.
</p>


<h3>Usage</h3>

<pre>
network(mat,
comp = NULL,
blocks = c(1,2),
cutoff = NULL,
row.names = TRUE,
col.names = TRUE,
block.var.names = TRUE,
color.node = NULL,
shape.node = NULL,
cex.node.name = 1,
color.edge = color.GreenRed(100),
lty.edge = "solid",
lwd.edge = 1,
show.edge.labels = FALSE,
cex.edge.label = 1,
show.color.key = TRUE,
symkey = TRUE,
keysize = c(1, 1),
keysize.label = 1,
breaks,
interactive = FALSE,
layout.fun = NULL,
save = NULL,
name.save = NULL)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>mat</code></td>
<td>
<p>numeric matrix of values to be represented.</p>
</td></tr>
<tr valign="top"><td><code>comp</code></td>
<td>
<p>atomic or vector of positive integers. The components to adequately account
for the data association. Defaults to <code>comp = 1</code>.</p>
</td></tr>
<tr valign="top"><td><code>cutoff</code></td>
<td>
<p>numeric value between <code>0</code> and <code>1</code>. The tuning
threshold for the relevant associations network (see Details).</p>
</td></tr>
<tr valign="top"><td><code>row.names, col.names</code></td>
<td>
<p>character vector containing the names of <i>X</i>- and
<i>Y</i>-variables.</p>
</td></tr>
<tr valign="top"><td><code>color.node</code></td>
<td>
<p>vector of length two, the colors of the <i>X</i> and
<i>Y</i>	nodes (see Details).</p>
</td></tr>
<tr valign="top"><td><code>shape.node</code></td>
<td>
<p>character vector of length two, the shape of the <i>X</i> and
<i>Y</i> nodes (see Details).</p>
</td></tr>
<tr valign="top"><td><code>color.edge</code></td>
<td>
<p>vector of colors or character string specifying the colors function to using
to color the edges, set to default to <code>color.GreenRed(100)</code> but other palettes can be chosen (see Details and Examples).</p>
</td></tr>
<tr valign="top"><td><code>lty.edge</code></td>
<td>
<p>character vector of length two, the line type for the edges (see Details).</p>
</td></tr>
<tr valign="top"><td><code>lwd.edge</code></td>
<td>
<p>vector of length two, the line width of the edges (see Details).</p>
</td></tr>
<tr valign="top"><td><code>show.edge.labels</code></td>
<td>
<p>logical. If <code>TRUE</code>, plot association values as edge
labels (defaults to <code>FALSE</code>).</p>
</td></tr>
<tr valign="top"><td><code>show.color.key</code></td>
<td>
<p>boolean. If <code>TRUE</code> a color key should be plotted.</p>
</td></tr>
<tr valign="top"><td><code>symkey</code></td>
<td>
<p>boolean indicating whether the color key should be made symmetric about 0.
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr valign="top"><td><code>keysize</code></td>
<td>
<p>numeric value indicating the size of the color key.</p>
</td></tr>
<tr valign="top"><td><code>keysize.label</code></td>
<td>
<p>vector of length 1, indicating the size of the labels and title of the color key.</p>
</td></tr>
<tr valign="top"><td><code>breaks</code></td>
<td>
<p>(optional) either a numeric vector indicating the splitting points for
binning <code>mat</code> into colors, or a integer number of break points to be used, in
which case the break points will be spaced equally between <code>min(mat)</code>
and <code>max(mat)</code>.</p>
</td></tr>
<tr valign="top"><td><code>interactive</code></td>
<td>
<p>logical. If <code>TRUE</code>, a scrollbar is created to change the
cutoff value interactively (defaults to <code>FALSE</code>). See Details.</p>
</td></tr>
<tr valign="top"><td><code>save</code></td>
<td>
<p>should the plot be saved ? If so, argument to be set either to <code>'jpeg'</code>, <code>'tiff'</code>, <code>'png'</code> or <code>'pdf'</code>.</p>
</td></tr>
<tr valign="top"><td><code>name.save</code></td>
<td>
<p>character string giving the name of the saved file.</p>
</td></tr>
<tr valign="top"><td><code>cex.edge.label</code></td>
<td>
<p>the font size for the edge labels.</p>
</td></tr>
<tr valign="top"><td><code>cex.node.name</code></td>
<td>
<p>the font size for the node labels.</p>
</td></tr>
<tr valign="top"><td><code>blocks</code></td>
<td>
<p>a vector indicating the block variables to display.</p>
</td></tr>
<tr valign="top"><td><code>block.var.names</code></td>
<td>
<p>either a list of vector components for variable names in each block or FALSE for no names. If TRUE, the columns names of the blocks are used as names.</p>
</td></tr>
<tr valign="top"><td><code>layout.fun</code></td>
<td>
<p>a function. It specifies how the vertices will be placed on the graph. See help(layout) in the igraph package. Defaults to layout.fruchterman.reingold.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>network</code> allows to infer large-scale association networks
between the <i>X</i> and <i>Y</i> datasets in <code>rcc</code> or <code>spls</code>. The output is a graph where
each <i>X</i>- and <i>Y</i>-variable corresponds to a node and the edges
included in the graph portray associations between them.
</p>
<p>In <code>rcc</code>, to identify <i>X</i>-<i>Y</i> pairs showing relevant associations, <code>network</code> calculate a
similarity measure between <i>X</i> and <i>Y</i> variables in a pair-wise manner: the
scalar product value between every pairs of vectors in dimension <code>length(comp)</code> representing
the variables <i>X</i> and <i>Y</i> on the axis defined by <i>Z_i</i> with <i>i</i> in <code>comp</code>,
where <i>Z_i</i> is the equiangular vector between the <i>i</i>-th <i>X</i> and <i>Y</i> canonical variate.
</p>
<p>In <code>spls</code>, if <code>object$mode</code> is <code>regression</code>, the similarity measure between <i>X</i> and
<i>Y</i> variables is given by the scalar product value between every pairs of vectors in dimension
<code>length(comp)</code> representing the variables <i>X</i> and <i>Y</i> on the axis defined by <i>U_i</i> with
<i>i</i> in <code>comp</code>, where <i>U_i</i> is the <i>i</i>-th <i>X</i> variate. If <code>object$mode</code> is
<code>canonical</code> then <i>X</i> and <i>Y</i> are represented on the axis defined by <i>U_i</i> and <i>V_i</i>
respectively.
</p>
<p>Variable pairs with a high similarity measure (in absolute value) are considered as relevant.
By changing the cutoff, one can tune the relevance of the associations to include or
exclude relationships in the network.
</p>
<p><code>interactive=TRUE</code> open two device, one for association network, one for scrollbar,
and define an interactive process: by clicking either at each end
('<i>-</i>' or '<i>+</i>') of the scrollbar or
at middle portion of this. The position of the slider indicate which is the &lsquo;cutoff&rsquo; value
associated to the display network.
</p>
<p>The network can be saved in a .glm format using the <span class="pkg">igraph</span> package, the function <code>write.graph</code> and extracting the output <code>obkect$gR</code>.
</p>
<p>The interactive process is terminated by clicking the second button and selecting &lsquo;Stop&rsquo;
from the menu, or from the &lsquo;Stop&rsquo; menu on the graphics window.
</p>
<p>The <code>color.node</code> is a vector of length two,
of any of the three kind of <code>R</code> colors, i.e., either a color name
(an element of <code>colors()</code>), a hexadecimal string of the form <code>"#rrggbb"</code>,
or an integer <code>i</code> meaning <code>palette()[i]</code>. <code>color.node[1]</code> and
<code>color.node[2]</code> give the color for filled nodes of the <i>X</i>- and <i>Y</i>-variables
respectively. Defaults to <code>c("white", "white")</code>.
</p>
<p><code>color.edge</code> give the color to edges with colors corresponding to the values in
<code>mat</code>. Defaults to <code>color.GreenRed(100)</code> for negative (green) and positive (red) correlations. We also propose other palettes of colors, such as <code>color.jet</code> and <code>color.spectral</code>, see help on those functions, and examples below. Other palette of colors from the stats package can be used too.
</p>
<p><code>shape.node[1]</code> and <code>shape.node[2]</code> provide the shape of the nodes associate
to <i>X</i>- and <i>Y</i>-variables respectively. Current acceptable values are
<code>"circle"</code> and <code>"rectangle"</code>. Defaults to <code>c("circle", "rectangle")</code>.
</p>
<p><code>lty.edge[1]</code> and <code>lty.egde[2]</code> give the line type to edges with positive
and negative weight respectively. Can be one of <code>"solid"</code>, <code>"dashed"</code>,
<code>"dotted"</code>, <code>"dotdash"</code>, <code>"longdash"</code> and <code>"twodash"</code>. Defaults
to <code>c("solid", "solid")</code>.
</p>
<p><code>lwd.edge[1]</code> and <code>lwd.edge[2]</code> provide the line width to edges with positive
and negative weight respectively. This attribute is of type double with
a default of <code>c(1, 1)</code>.
</p>


<h3>Value</h3>

<p><code>network</code> return a list containing the following components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>M</code></td>
<td>
<p>the correlation matrix used by <code>network</code>.</p>
</td></tr>
<tr valign="top"><td><code>gR</code></td>
<td>
<p>a <code>graph</code> object to save the graph for cytoscape use (requires to load the <span class="pkg">igraph</span> package).</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>If the number of variables is high, the generation of the network generation can take some time.
</p>


<h3>Author(s)</h3>

<p>Ignacio González and Kim-Anh Lê Cao.</p>


<h3>References</h3>

<p>Mathematical definition:
González I., Lê Cao K-A., Davis, M.J. and Déjean, S. (2012). Visualising associations between paired omics data sets. J. Data Mining 5:19. <a href="http://www.biodatamining.org/content/5/1/19/abstract">http://www.biodatamining.org/content/5/1/19/abstract</a>
</p>
<p>Examples and illustrations:
</p>
<p>Rohart F, Gautier B, Singh A, Lê Cao K-A. mixOmics: an R package for 'omics feature selection and multiple data integration. PLoS Comput Biol 13(11): e1005752
</p>
<p>Relevance networks:
</p>
<p>Butte, A. J., Tamayo, P., Slonim, D., Golub, T. R. and Kohane, I. S. (2000).
Discovering functional relationships between RNA expression and chemotherapeutic
susceptibility using relevance networks. <em>Proceedings of the National Academy
of Sciences of the USA</em> <b>97</b>, 12182-12186.
</p>
<p>Moriyama, M., Hoshida, Y., Otsuka, M., Nishimura, S., Kato, N., Goto, T., Taniguchi, H.,
Shiratori, Y., Seki, N. and Omata, M. (2003). Relevance Network between Chemosensitivity
and Transcriptome in Human Hepatoma Cells. <em>Molecular Cancer Therapeutics</em> <b>2</b>,
199-205.
</p>


<h3>See Also</h3>

<p><code><a href="plotVar.html">plotVar</a></code>, <code><a href="cim.html">cim</a></code>, <code><a href="colors.html">color.GreenRed</a></code>, <code><a href="colors.html">color.jet</a></code>, <code><a href="colors.html">color.spectral</a></code>
and http: //www.mixOmics.org for more details.</p>


<h3>Examples</h3>

<pre>

## network representation for objects of class 'rcc'
data(nutrimouse)
X &lt;- nutrimouse$lipid
Y &lt;- nutrimouse$gene
nutri.res &lt;- rcc(X, Y, ncomp = 3, lambda1 = 0.064, lambda2 = 0.008)

## Not run: 
# may not work on the Linux version, use Windows instead
# sometimes with Rstudio might not work because of margin issues,
# in that case save it as an image
jpeg('example1-network.jpeg', res = 600, width = 4000, height = 4000)
network(nutri.res, comp = 1:3, cutoff = 0.6)
dev.off()

## End(Not run)

## Not run: 
## Changing the attributes of the network

# sometimes with Rstudio might not work because of margin issues,
# in that case save it as an image
jpeg('example2-network.jpeg')
network(nutri.res, comp = 1:3, cutoff = 0.45,
color.node = c("mistyrose", "lightcyan"),
shape.node = c("circle", "rectangle"),
color.edge = color.jet(100),
lty.edge = "solid", lwd.edge = 2,
show.edge.labels = FALSE)
dev.off()


## interactive 'cutoff'

network(nutri.res, comp = 1:3, cutoff = 0.55, interactive = TRUE)
## select the 'cutoff' and "see" the new network

## network representation for objects of class 'spls'
data(liver.toxicity)
X &lt;- liver.toxicity$gene
Y &lt;- liver.toxicity$clinic
toxicity.spls &lt;- spls(X, Y, ncomp = 3, keepX = c(50, 50, 50),
keepY = c(10, 10, 10))

# sometimes with Rstudio might not work because of margin issues,
# in that case save it as an image
jpeg('example3-network.jpeg')
network(toxicity.spls, comp = 1:3, cutoff = 0.8,
color.node = c("mistyrose", "lightcyan"),
shape.node = c("rectangle", "circle"),
color.edge = color.spectral(100),
lty.edge = "solid", lwd.edge =  1,
show.edge.labels = FALSE, interactive = FALSE)
dev.off()

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>mixOmics</em> version 6.10.8 <a href="00Index.html">Index</a>]</div>
</body></html>
