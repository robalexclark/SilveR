<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Wrapper function to tune pls-derived methods.</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for tune {mixOmics}"><tr><td>tune {mixOmics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Wrapper function to tune pls-derived methods.</h2>

<h3>Description</h3>

<p>This function uses repeated cross-validation to tune hyperparameters such as
the number of features to select and possibly the number of components to
extract.
</p>


<h3>Usage</h3>

<pre>
tune(
  method = c("spls", "splsda", "mint.splsda", "rcc", "pca", "spca"),
  X,
  Y,
  multilevel = NULL,
  ncomp,
  study,
  test.keepX = c(5, 10, 15),
  test.keepY = NULL,
  already.tested.X,
  already.tested.Y,
  mode = c("regression", "canonical", "invariant", "classic"),
  nrepeat = 1,
  grid1 = seq(0.001, 1, length = 5),
  grid2 = seq(0.001, 1, length = 5),
  validation = "Mfold",
  folds = 10,
  dist = "max.dist",
  measure = ifelse(method == "spls", "cor", "BER"),
  auc = FALSE,
  progressBar = FALSE,
  near.zero.var = FALSE,
  logratio = c("none", "CLR"),
  center = TRUE,
  scale = TRUE,
  max.iter = 100,
  tol = 1e-09,
  light.output = TRUE,
  cpus = 1
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>method</code></td>
<td>
<p>This parameter is used to pass all other argument to the
suitable function. <code>method</code> has to be one of the following: &quot;spls&quot;,
&quot;splsda&quot;, &quot;mint.splsda&quot;, &quot;rcc&quot;, &quot;pca&quot;, &quot;spca&quot; or &quot;pls&quot;.</p>
</td></tr>
<tr valign="top"><td><code>X</code></td>
<td>
<p>numeric matrix of predictors. <code>NA</code>s are allowed.</p>
</td></tr>
<tr valign="top"><td><code>Y</code></td>
<td>
<p>Either a factor or a class vector for the discrete outcome, or a
numeric vector or matrix of continuous responses (for multi-response
models).</p>
</td></tr>
<tr valign="top"><td><code>multilevel</code></td>
<td>
<p>Design matrix for multilevel analysis (for repeated
measurements) that indicates the repeated measures on each individual, i.e.
the individuals ID. See Details.</p>
</td></tr>
<tr valign="top"><td><code>ncomp</code></td>
<td>
<p>the number of components to include in the model.</p>
</td></tr>
<tr valign="top"><td><code>study</code></td>
<td>
<p>grouping factor indicating which samples are from the same
study</p>
</td></tr>
<tr valign="top"><td><code>test.keepX</code></td>
<td>
<p>numeric vector for the different number of variables to
test from the <i>X</i> data set</p>
</td></tr>
<tr valign="top"><td><code>test.keepY</code></td>
<td>
<p>If <code>method = 'spls'</code>, numeric vector for the
different number of variables to test from the <i>Y</i> data set</p>
</td></tr>
<tr valign="top"><td><code>already.tested.X</code></td>
<td>
<p>Optional, if <code>ncomp &gt; 1</code> A numeric vector
indicating the number of variables to select from the <i>X</i> data set on
the firsts components.</p>
</td></tr>
<tr valign="top"><td><code>already.tested.Y</code></td>
<td>
<p>if <code>method = 'spls'</code> and <code>if(ncomp &gt; 1)</code>
numeric vector indicating the number of variables to select from the <i>Y</i>
data set on the first components</p>
</td></tr>
<tr valign="top"><td><code>mode</code></td>
<td>
<p>character string. What type of algorithm to use, (partially)
matching one of <code>"regression"</code>, <code>"canonical"</code>, <code>"invariant"</code>
or <code>"classic"</code>. See Details.</p>
</td></tr>
<tr valign="top"><td><code>nrepeat</code></td>
<td>
<p>Number of times the Cross-Validation process is repeated.</p>
</td></tr>
<tr valign="top"><td><code>grid1, grid2</code></td>
<td>
<p>vector numeric defining the values of <code>lambda1</code> and
<code>lambda2</code> at which cross-validation score should be computed. Defaults
to <code>grid1=grid2=seq(0.001, 1, length=5)</code>.</p>
</td></tr>
<tr valign="top"><td><code>validation</code></td>
<td>
<p>character.  What kind of (internal) validation to use,
matching one of <code>"Mfold"</code> or <code>"loo"</code> (see below). Default is
<code>"Mfold"</code>.</p>
</td></tr>
<tr valign="top"><td><code>folds</code></td>
<td>
<p>the folds in the Mfold cross-validation. See Details.</p>
</td></tr>
<tr valign="top"><td><code>dist</code></td>
<td>
<p>distance metric to estimate the
classification error rate, should be a subset of <code>"centroids.dist"</code>,
<code>"mahalanobis.dist"</code> or <code>"max.dist"</code> (see Details).</p>
</td></tr>
<tr valign="top"><td><code>measure</code></td>
<td>
<p>The tuning measure used for different methods. See details.</p>
</td></tr>
<tr valign="top"><td><code>auc</code></td>
<td>
<p>if <code>TRUE</code> calculate the Area Under the Curve (AUC)
performance of the model.</p>
</td></tr>
<tr valign="top"><td><code>progressBar</code></td>
<td>
<p>by default set to <code>TRUE</code> to output the progress bar
of the computation.</p>
</td></tr>
<tr valign="top"><td><code>near.zero.var</code></td>
<td>
<p>Logical, see the internal <code><a href="../../mixOmics/help/nearZeroVar.html">nearZeroVar</a></code>
function (should be set to TRUE in particular for data with many zero
values). Default value is FALSE</p>
</td></tr>
<tr valign="top"><td><code>logratio</code></td>
<td>
<p>one of ('none','CLR'). Default to 'none'</p>
</td></tr>
<tr valign="top"><td><code>center</code></td>
<td>
<p>a logical value indicating whether the variables should be
shifted to be zero centered. Alternately, a vector of length equal the
number of columns of <code>X</code> can be supplied. The value is passed to
<code><a href="../../base/html/scale.html">scale</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p>a logical value indicating whether the variables should be
scaled to have unit variance before the analysis takes place. The default is
<code>FALSE</code> for consistency with <code>prcomp</code> function, but in general
scaling is advisable. Alternatively, a vector of length equal the number of
columns of <code>X</code> can be supplied. The value is passed to
<code><a href="../../base/html/scale.html">scale</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>max.iter</code></td>
<td>
<p>Integer, the maximum number of iterations.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>Numeric, convergence tolerance criteria.</p>
</td></tr>
<tr valign="top"><td><code>light.output</code></td>
<td>
<p>if set to FALSE, the prediction/classification of each
sample for each of <code>test.keepX</code> and each comp is returned.</p>
</td></tr>
<tr valign="top"><td><code>cpus</code></td>
<td>
<p>Integer, number of cores to use for parallel processing. 
Currently only available for <code>method = "spls"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the help file corresponding to the corresponding <code>method</code>, e.g.
<code>tune.splsda</code> for further details. Note that only the arguments used in
the tune function corresponding to <code>method</code> are passed on.
</p>
<p>More details about the prediction distances in <code>?predict</code> and the
supplemental material of the mixOmics article (Rohart et al. 2017). More
details about the PLS modes are in <code>?pls</code>.
</p>


<h3>Value</h3>

<p>Depending on the type of analysis performed and the input arguments,
a list that may contain:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>error.rate</code></td>
<td>
<p>returns the prediction error for each <code>test.keepX</code> on
each component, averaged across all repeats and subsampling folds. Standard
deviation is also output. All error rates are also available as a list.</p>
</td></tr>
<tr valign="top"><td><code>choice.keepX</code></td>
<td>
<p>returns the number of variables selected (optimal keepX)
on each component.</p>
</td></tr> <tr valign="top"><td><code>choice.ncomp</code></td>
<td>
<p>For supervised models; returns the
optimal number of components for the model for each prediction distance
using one-sided t-tests that test for a significant difference in the mean
error rate (gain in prediction) when components are added to the model. See
more details in Rohart et al 2017 Suppl. For more than one block, an optimal
ncomp is returned for each prediction framework.</p>
</td></tr>
<tr valign="top"><td><code>error.rate.class</code></td>
<td>
<p>returns the error rate for each level of <code>Y</code>
and for each component computed with the optimal keepX</p>
</td></tr>
<tr valign="top"><td><code>predict</code></td>
<td>
<p>Prediction values for each sample, each <code>test.keepX</code>,
each comp and each repeat. Only if light.output=FALSE</p>
</td></tr>
<tr valign="top"><td><code>class</code></td>
<td>
<p>Predicted class for each sample, each <code>test.keepX</code>, each
comp and each repeat. Only if light.output=FALSE</p>
</td></tr>
<tr valign="top"><td><code>auc</code></td>
<td>
<p>AUC mean and standard deviation if the number of categories in
<code>Y</code> is greater than 2, see details above. Only if auc = TRUE</p>
</td></tr>
<tr valign="top"><td><code>cor.value</code></td>
<td>
<p>only if multilevel analysis with 2 factors: correlation
between latent variables.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florian Rohart, Francois Bartolo, Kim-Anh Lê Cao, Al J Abadi
</p>


<h3>References</h3>

<p>Singh A., Shannon C., Gautier B., Rohart F., Vacher M., Tebbutt S.
and Lê Cao K.A. (2019), DIABLO: an integrative approach for identifying key 
molecular drivers from multi-omics assays, Bioinformatics, 
Volume 35, Issue 17, 1 September 2019, Pages 3055–3062.	
</p>
<p>mixOmics article:
</p>
<p>Rohart F, Gautier B, Singh A, Lê Cao K-A. mixOmics: an R package for 'omics
feature selection and multiple data integration. PLoS Comput Biol 13(11):
e1005752
</p>
<p>MINT:
</p>
<p>Rohart F, Eslami A, Matigian, N, Bougeard S, Lê Cao K-A (2017). MINT: A
multivariate integrative approach to identify a reproducible biomarker
signature across multiple experiments and platforms. BMC Bioinformatics
18:128.
</p>
<p>PLS and PLS citeria for PLS regression: Tenenhaus, M. (1998). <em>La
regression PLS: theorie et pratique</em>. Paris: Editions Technic.
</p>
<p>Chavent, Marie and Patouille, Brigitte (2003). Calcul des coefficients de
regression et du PRESS en regression PLS1. <em>Modulad n</em>, <b>30</b> 1-11.
(this is the formula we use to calculate the Q2 in perf.pls and perf.spls)
</p>
<p>Mevik, B.-H., Cederkvist, H. R. (2004). Mean Squared Error of Prediction
(MSEP) Estimates for Principal Component Regression (PCR) and Partial Least
Squares Regression (PLSR). <em>Journal of Chemometrics</em> <b>18</b>(9),
422-429.
</p>
<p>sparse PLS regression mode:
</p>
<p>Lê Cao, K. A., Rossouw D., Robert-Granie, C. and Besse, P. (2008). A sparse
PLS for variable selection when integrating Omics data. <em>Statistical
Applications in Genetics and Molecular Biology</em> <b>7</b>, article 35.
</p>
<p>One-sided t-tests (suppl material):
</p>
<p>Rohart F, Mason EA, Matigian N, Mosbergen R, Korn O, Chen T, Butcher S,
Patel J, Atkinson K, Khosrotehrani K, Fisk NM, Lê Cao K-A&amp;, Wells CA&amp;
(2016). A Molecular Classification of Human Mesenchymal Stromal Cells. PeerJ
4:e1845.
</p>


<h3>See Also</h3>

<p><code><a href="../../mixOmics/help/tune.rcc.html">tune.rcc</a></code>, <code><a href="../../mixOmics/help/tune.mint.splsda.html">tune.mint.splsda</a></code>,
<code><a href="../../mixOmics/help/tune.pca.html">tune.pca</a></code>, <code><a href="../../mixOmics/help/tune.splsda.html">tune.splsda</a></code>,
<code><a href="../../mixOmics/help/tune.splslevel.html">tune.splslevel</a></code> and http://www.mixOmics.org for more details.
</p>


<h3>Examples</h3>

<pre>
## sPLS-DA
data(breast.tumors)
X &lt;- breast.tumors$gene.exp
Y &lt;- as.factor(breast.tumors$sample$treatment)
tune= tune(method = "splsda", X, Y, ncomp=1, nrepeat=10, logratio="none",
test.keepX = c(5, 10, 15), folds=10, dist="max.dist", progressBar = TRUE)

plot(tune)

## Not run: 
## mint.splsda

data(stemcells)
data = stemcells$gene
type.id = stemcells$celltype
exp = stemcells$study

out = tune(method="mint.splsda", X=data,Y=type.id, ncomp=2, study=exp, test.keepX=seq(1,10,1))
out$choice.keepX

plot(out)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>mixOmics</em> version 6.18.1 <a href="00Index.html">Index</a>]</div>
</div></body></html>
