<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Within matrix decomposition for repeated measurements...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for withinVariation {mixOmics}"><tr><td>withinVariation {mixOmics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Within matrix decomposition for repeated measurements (cross-over design)</h2>

<h3>Description</h3>

<p>This function is internally called by <code>pca</code>, <code>pls</code>, <code>spls</code>,
<code>plsda</code> and <code>splsda</code> functions for cross-over design data, but can
be called independently prior to any kind of multivariate analyses.
</p>


<h3>Usage</h3>

<pre>
withinVariation(X, design)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
<p>numeric matrix of predictors. <code>NA</code>s are allowed.</p>
</td></tr>
<tr valign="top"><td><code>design</code></td>
<td>
<p>a numeric matrix or data frame. The first column indicates the
repeated measures on each individual, i.e. the individuals ID. The 2nd and
3rd columns are to split the variation for a 2 level factor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>withinVariation</code> function decomposes the Within variation in the
<i>X</i> data set. The resulting <i>Xw</i> matrix is then input in the
<code>multilevel</code> function.
</p>
<p>One or two-factor analyses are available.
</p>


<h3>Value</h3>

<p><code>withinVariation</code> simply returns the <i>Xw</i> within matrix,
which can be input in the other multivariate approaches already implemented
in mixOmics (i.e. spls or splsda, see <code>multilevel</code>, but also pca or
ipca).
</p>


<h3>Author(s)</h3>

<p>Benoit Liquet, Kim-Anh Lê Cao, Benoit Gautier, Ignacio González,
Florian Rohart, AL J Abadi
</p>


<h3>References</h3>

<p>On multilevel analysis:
</p>
<p>Liquet, B., Lê Cao, K.-A., Hocini, H. and Thiebaut, R. (2012) A novel
approach for biomarker selection and the integration of repeated measures
experiments from two platforms. <em>BMC Bioinformatics</em> <b>13</b>:325.
</p>
<p>Westerhuis, J. A., van Velzen, E. J., Hoefsloot, H. C., and Smilde, A. K.
(2010). Multivariate paired data analysis: multilevel PLSDA versus OPLSDA.
<em>Metabolomics</em>, <b>6</b>(1), 119-128.
</p>


<h3>See Also</h3>

<p><code><a href="../../mixOmics/help/spls.html">spls</a></code>, <code><a href="../../mixOmics/help/splsda.html">splsda</a></code>, <code><a href="../../mixOmics/help/plotIndiv.html">plotIndiv</a></code>,
<code><a href="../../mixOmics/help/plotVar.html">plotVar</a></code>, <code><a href="../../mixOmics/help/cim.html">cim</a></code>, <code><a href="../../mixOmics/help/network.html">network</a></code>.
</p>


<h3>Examples</h3>

<pre>
## Example: one-factor analysis matrix decomposition
#--------------------------------------------------------------
data(vac18)
X &lt;- vac18$genes
# in design we only need to mention the repeated measurements to split the one level variation
design &lt;- data.frame(sample = vac18$sample)

Xw &lt;- withinVariation(X = X, design = design)
# multilevel PCA
res.pca.1level &lt;- pca(Xw, ncomp = 3)

# compare a normal PCA with a multilevel PCA for repeated measurements.
# note: PCA makes the assumptions that all samples are independent,
# so this analysis is flawed and you should use a multilevel PCA instead
res.pca &lt;- pca(X, ncomp = 3)

# set up colors for plotIndiv
col.stim &lt;- c("darkblue", "purple", "green4","red3")
col.stim &lt;- col.stim[as.numeric(vac18$stimulation)]

# plotIndiv comparing both PCA and PCA multilevel
plotIndiv(res.pca, ind.names = vac18$stimulation, group = col.stim)
title(main = 'PCA ')
plotIndiv(res.pca.1level, ind.names = vac18$stimulation, group = col.stim)
title(main = 'PCA multilevel')

</pre>

<hr /><div style="text-align: center;">[Package <em>mixOmics</em> version 6.18.1 <a href="00Index.html">Index</a>]</div>
</div></body></html>
