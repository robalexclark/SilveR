<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot of Variables</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for plotVar {mixOmics}"><tr><td>plotVar {mixOmics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Plot of Variables</h2>

<h3>Description</h3>

<p>This function provides variables representation for (regularized) CCA, (sparse) PLS regression, PCA and (sparse) Regularized generalised CCA.
</p>


<h3>Usage</h3>

<pre>
plotVar(object,
comp = NULL,
comp.select = comp,
plot=TRUE,
var.names = NULL,
blocks = NULL, # to choose which block data to plot, when using GCCA module
X.label = NULL,
Y.label = NULL,
Z.label = NULL,
abline = TRUE,
col,
cex,
pch,
font,
cutoff = 0,
rad.in = 0.5,
title="Correlation Circle Plots",
legend = FALSE,
legend.title = "Block",
style="ggplot2", # can choose between graphics,3d, lattice or ggplot2,
overlap = TRUE,
axes.box = "all",
label.axes.box = "both")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>object of class inheriting from <code>"rcc"</code>, <code>"pls"</code>, <code>"plsda"</code>,
<code>"spls"</code>, <code>"splsda"</code>, <code>"pca"</code> or <code>"spca"</code>.</p>
</td></tr>
<tr valign="top"><td><code>comp</code></td>
<td>
<p>integer vector of length two. The components that will be used on the horizontal
and the vertical axis respectively to project the variables. By default, comp=c(1,2) except when style='3d', comp=c(1:3) </p>
</td></tr>
<tr valign="top"><td><code>comp.select</code></td>
<td>
<p>for the sparse versions, an input vector indicating the components on which the variables were selected. Only those selected variables are displayed. By default, comp.select=comp</p>
</td></tr>
<tr valign="top"><td><code>plot</code></td>
<td>
<p>if TRUE (the default) then a plot is produced. If not, the summaries which the plots are based on are returned.</p>
</td></tr>
<tr valign="top"><td><code>var.names</code></td>
<td>
<p>either a character vector of names for the variables to be plotted,
or <code>FALSE</code> for no names. If <code>TRUE</code>, the col names of the first (or second)
data matrix is used as names.</p>
</td></tr>
<tr valign="top"><td><code>blocks</code></td>
<td>
<p>for an object of class <code>"rgcca"</code> or <code>"sgcca"</code>, a numerical vector indicating the block variables to display.</p>
</td></tr>
<tr valign="top"><td><code>X.label</code></td>
<td>
<p>x axis titles.</p>
</td></tr>
<tr valign="top"><td><code>Y.label</code></td>
<td>
<p>y axis titles.</p>
</td></tr>
<tr valign="top"><td><code>Z.label</code></td>
<td>
<p>z axis titles (when style = '3d').</p>
</td></tr>
<tr valign="top"><td><code>abline</code></td>
<td>
<p>should the vertical and horizontal line through the center be plotted? Default set to <code>FALSE</code></p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>character or integer vector of colors for plotted character and symbols, can be of length 2 (one for each data set) or of length (p+q) (i.e. the total number of variables).
See Details.</p>
</td></tr>
<tr valign="top"><td><code>cex</code></td>
<td>
<p>numeric vector of character expansion sizes for the plotted character and symbols, can be of length 2 (one for each data set) or of length (p+q) (i.e. the total number of variables).</p>
</td></tr>
<tr valign="top"><td><code>pch</code></td>
<td>
<p>plot character. A vector of single characters
or integers, can be of length 2 (one for each data set) or of length (p+q) (i.e. the total number of variables). See <code><a href="../../graphics/html/points.html">points</a></code> for all alternatives.</p>
</td></tr>
<tr valign="top"><td><code>font</code></td>
<td>
<p>numeric vector of font to be used, can be of length 2 (one for each data set) or of length (p+q) (i.e. the total number of variables). See <code><a href="../../graphics/html/par.html">par</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>cutoff</code></td>
<td>
<p>numeric between 0 and 1. Variables with correlations below this cutoff in absolute value are not plotted (see Details).</p>
</td></tr>
<tr valign="top"><td><code>rad.in</code></td>
<td>
<p>numeric between 0 and 1, the radius of the inner circle. Defaults to <code>0.5</code>.</p>
</td></tr>
<tr valign="top"><td><code>title</code></td>
<td>
<p>character indicating the title plot.</p>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p>boolean when more than 3 blocks. Can be a character vector when one or 2 blocks
to customize the legend. See examples. Default is FALSE.</p>
</td></tr>
<tr valign="top"><td><code>legend.title</code></td>
<td>
<p>title of the legend</p>
</td></tr>
<tr valign="top"><td><code>style</code></td>
<td>
<p>argument to be set to either <code>'graphics'</code>, <code>'lattice'</code>, <code>'ggplot2'</code> or <code>'3d'</code> for a style of plotting.</p>
</td></tr>
<tr valign="top"><td><code>overlap</code></td>
<td>
<p>boolean. Whether the variables should be plotted in one single figure. Default is TRUE.</p>
</td></tr>
<tr valign="top"><td><code>axes.box</code></td>
<td>
<p>for style '3d', argument to be set to either <code>'axes'</code>, <code>'box'</code>, <code>'bbox'</code> or <code>'all'</code>, defining the shape of the box.</p>
</td></tr>
<tr valign="top"><td><code>label.axes.box</code></td>
<td>
<p>for style '3d', argument to be set to either <code>'axes'</code>, <code>'box'</code>, <code>'both'</code>, indicating which labels to print.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plotVar</code> produce a &quot;correlation circle&quot;, i.e. the correlations
between each variable and the selected components are plotted as scatter plot,
with concentric circles of radius one et radius given by <code>rad.in</code>. Each point
corresponds to a variable. For (regularized) CCA the
components correspond to the equiangular vector between <i>X</i>- and <i>Y</i>-variates.
For (sparse) PLS regression mode the components correspond to the <i>X</i>-variates. If mode is
canonical, the components for <i>X</i> and <i>Y</i> variables correspond to
the <i>X</i>- and <i>Y</i>-variates respectively.
</p>
<p>For <code>plsda</code> and <code>splsda</code> objects, only the <i>X</i> variables are represented.
</p>
<p>For <code>spls</code> and <code>splsda</code> objects, only the <i>X</i> and <i>Y</i> variables selected on
dimensions <code>comp</code> are represented.
</p>
<p>The arguments <code>col</code>, <code>pch</code>, <code>cex</code> and <code>font</code> can be either vectors of
length two or a list with two vector components of length <i>p</i> and <i>q</i> respectively,
where <i>p</i> is the number of <i>X</i>-variables and <i>q</i>
is the number of <i>Y</i>-variables. In the first case, the first and second component of the
vector determine the graphics attributes for the <i>X</i>- and <i>Y</i>-variables respectively.
Otherwise, multiple arguments values can be specified so that each point (variable)
can be given its own graphic attributes. In this case, the first component of the list
correspond to the <i>X</i> attributs and the second component correspond to
the <i>Y</i> attributs. Default values exist for this arguments.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a vector of coordinates of the variables on the x-axis.</p>
</td></tr>
<tr valign="top"><td><code>y</code></td>
<td>
<p>a vector of coordinates of the variables on the y-axis.</p>
</td></tr>
<tr valign="top"><td><code>Block</code></td>
<td>
<p>the data block name each variable belongs to.</p>
</td></tr>
<tr valign="top"><td><code>names</code></td>
<td>
<p>the name of each variable, matching their coordinates values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ignacio González, Kim-Anh Lê Cao, Benoit Gautier, Florian Rohart, Francois Bartolo.</p>


<h3>References</h3>

<p>González I., Lê Cao K-A., Davis, M.J. and Déjean, S. (2012). Visualising associations between paired 'omics data sets. J. Data Mining 5:19. <a href="http://www.biodatamining.org/content/5/1/19/abstract">http://www.biodatamining.org/content/5/1/19/abstract</a></p>


<h3>See Also</h3>

<p><code><a href="cim.html">cim</a></code>, <code><a href="network.html">network</a></code>, <code><a href="../../graphics/html/par.html">par</a></code> and http://www.mixOmics.org for more details.</p>


<h3>Examples</h3>

<pre>
## variable representation for objects of class 'rcc'
# ----------------------------------------------------
data(nutrimouse)
X &lt;- nutrimouse$lipid
Y &lt;- nutrimouse$gene
nutri.res &lt;- rcc(X, Y, ncomp = 3, lambda1 = 0.064, lambda2 = 0.008)

plotVar(nutri.res) #(default)


plotVar(nutri.res, comp = c(1,3), cutoff = 0.5)

## Not run: 
## variable representation for objects of class 'pls' or 'spls'
# ----------------------------------------------------
data(liver.toxicity)
X &lt;- liver.toxicity$gene
Y &lt;- liver.toxicity$clinic
toxicity.spls &lt;- spls(X, Y, ncomp = 3, keepX = c(50, 50, 50),
keepY = c(10, 10, 10))

plotVar(toxicity.spls, cex = c(1,0.8))

# with a customized legend
plotVar(toxicity.spls, legend = c("block 1", "my block 2"),
legend.title="my legend")

## variable representation for objects of class 'splsda'
# ----------------------------------------------------

data(liver.toxicity)
X &lt;- liver.toxicity$gene
Y &lt;- as.factor(liver.toxicity$treatment[, 4])

ncomp &lt;- 2
keepX &lt;- rep(20, ncomp)

splsda.liver &lt;- splsda(X, Y, ncomp = ncomp, keepX = keepX)
plotVar(splsda.liver)

## variable representation for objects of class 'sgcca' (or 'rgcca')
# ----------------------------------------------------
## see example in ??wrapper.sgcca
data(nutrimouse)
# need to unmap the Y factor diet
Y = unmap(nutrimouse$diet)
# set up the data as list
data = list(gene = nutrimouse$gene, lipid = nutrimouse$lipid, Y = Y)

# set up the design matrix:
# with this design, gene expression and lipids are connected to the diet factor
# design = matrix(c(0,0,1,
#                   0,0,1,
#                   1,1,0), ncol = 3, nrow = 3, byrow = TRUE)

# with this design, gene expression and lipids are connected to the diet factor
# and gene expression and lipids are also connected
design = matrix(c(0,1,1,
1,0,1,
1,1,0), ncol = 3, nrow = 3, byrow = TRUE)


#note: the penalty parameters will need to be tuned
wrap.result.sgcca = wrapper.sgcca(X = data, design = design, penalty = c(.3,.3, 1),
ncomp = 2,
scheme = "centroid")
wrap.result.sgcca

#variables selected on component 1 for each block
selectVar(wrap.result.sgcca, comp = 1, block = c(1,2))$'gene'$name
selectVar(wrap.result.sgcca, comp = 1, block = c(1,2))$'lipid'$name

#variables selected on component 2 for each block
selectVar(wrap.result.sgcca, comp = 2, block = c(1,2))$'gene'$name
selectVar(wrap.result.sgcca, comp = 2, block = c(1,2))$'lipid'$name

plotVar(wrap.result.sgcca, comp = c(1,2), block = c(1,2), comp.select = c(1,1),
title = c('Variables selected on component 1 only'))


plotVar(wrap.result.sgcca, comp = c(1,2), block = c(1,2), comp.select = c(2,2),
title = c('Variables selected on component 2 only'))

# -&gt; this one shows the variables selected on both components
plotVar(wrap.result.sgcca, comp = c(1,2), block = c(1,2),
title = c('Variables selected on components 1 and 2'))

## variable representation for objects of class 'rgcca'
# ----------------------------------------------------

data(nutrimouse)
# need to unmap Y for an unsupervised analysis, where Y is included as a data block in data
Y = unmap(nutrimouse$diet)

data = list(gene = nutrimouse$gene, lipid = nutrimouse$lipid, Y = Y)
# with this design, all blocks are connected
design = matrix(c(0,1,1,1,0,1,1,1,0), ncol = 3, nrow = 3,
byrow = TRUE, dimnames = list(names(data), names(data)))

nutrimouse.rgcca &lt;- wrapper.rgcca(X = data,
design = design,
tau = "optimal",
ncomp = 2,
scheme = "centroid")

plotVar(nutrimouse.rgcca, comp = c(1,2), block = c(1,2), cex = c(1.5, 1.5))


plotVar(nutrimouse.rgcca, comp = c(1,2), block = c(1,2))


# set up the data as list
data = list(gene = nutrimouse$gene, lipid = nutrimouse$lipid, Y =Y)
# with this design, gene expression and lipids are connected to the diet factor
# design = matrix(c(0,0,1,
#                   0,0,1,
#                   1,1,0), ncol = 3, nrow = 3, byrow = TRUE)

# with this design, gene expression and lipids are connected to the diet factor
# and gene expression and lipids are also connected
design = matrix(c(0,1,1,
1,0,1,
1,1,0), ncol = 3, nrow = 3, byrow = TRUE)
#note: the tau parameter is the regularization parameter
wrap.result.rgcca = wrapper.rgcca(X = data, design = design, tau = c(1, 1, 0),
ncomp = 2,
scheme = "centroid")
#wrap.result.rgcca
plotVar(wrap.result.rgcca, comp = c(1,2), block = c(1,2))


## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>mixOmics</em> version 6.10.8 <a href="00Index.html">Index</a>]</div>
</body></html>
