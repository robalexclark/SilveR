<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Estimate the parameters of mint.splsda method</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for tune.mint.splsda {mixOmics}"><tr><td>tune.mint.splsda {mixOmics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Estimate the parameters of mint.splsda method</h2>

<h3>Description</h3>

<p>Computes Leave-One-Group-Out-Cross-Validation (LOGOCV) scores on a user-input
grid to determine optimal values for the sparsity parameters in <code>mint.splsda</code>.
</p>


<h3>Usage</h3>

<pre>
tune.mint.splsda(X, Y, ncomp = 1, study, test.keepX = c(5, 10, 15), already.tested.X,
dist = "max.dist", measure = "BER", auc = FALSE, progressBar = TRUE,
scale = TRUE, tol = 1e-06, max.iter = 100, near.zero.var = FALSE, light.output = TRUE )
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>X</code></td>
<td>
<p>numeric matrix of predictors. <code>NA</code>s are allowed.</p>
</td></tr>
<tr valign="top"><td><code>Y</code></td>
<td>
<p>Outcome. Numeric vector or matrix of responses (for multi-response models)</p>
</td></tr>
<tr valign="top"><td><code>ncomp</code></td>
<td>
<p>Number of components to include in the model (see Details). Default to 1</p>
</td></tr>
<tr valign="top"><td><code>study</code></td>
<td>
<p>grouping factor indicating which samples are from the same study</p>
</td></tr>
<tr valign="top"><td><code>test.keepX</code></td>
<td>
<p>numeric vector for the different number of variables to test from the <i>X</i> data set</p>
</td></tr>
<tr valign="top"><td><code>already.tested.X</code></td>
<td>
<p>if <code>ncomp &gt; 1</code> Numeric vector indicating the number of variables to select from the <i>X</i> data set on the firsts components </p>
</td></tr>
<tr valign="top"><td><code>dist</code></td>
<td>
<p>only applies to an object inheriting from <code>"plsda"</code> or <code>"splsda"</code> to evaluate the classification performance of the model. Should be a subset of <code>"max.dist"</code>, <code>"centroids.dist"</code>, <code>"mahalanobis.dist"</code>. Default is <code>"all"</code>. See <code><a href="../../stats/html/predict.html">predict</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>measure</code></td>
<td>
<p>Two misclassification measure are available: overall misclassification error <code>overall</code> or the Balanced Error Rate <code>BER</code></p>
</td></tr>
<tr valign="top"><td><code>auc</code></td>
<td>
<p>if <code>TRUE</code> calculate the Area Under the Curve (AUC) performance of the model.</p>
</td></tr>
<tr valign="top"><td><code>progressBar</code></td>
<td>
<p>by default set to <code>TRUE</code> to output the progress bar of the computation.</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p>boleean. If scale = TRUE, each block is standardized
to zero means and unit variances (default: TRUE)</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>Convergence stopping value.</p>
</td></tr>
<tr valign="top"><td><code>max.iter</code></td>
<td>
<p>integer, the maximum number of iterations.</p>
</td></tr>
<tr valign="top"><td><code>near.zero.var</code></td>
<td>
<p>boolean, see the internal <code><a href="nearZeroVar.html">nearZeroVar</a></code> function (should be set to TRUE in particular for data with many zero values). Default value is FALSE</p>
</td></tr>
<tr valign="top"><td><code>light.output</code></td>
<td>
<p>if set to FALSE, the prediction/classification of each sample for each of <code>test.keepX</code> and each comp is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a Leave-One-Group-Out-Cross-Validation (LOGOCV), where each of <code>study</code> is left out once. It returns a list of variables of <code>X</code> that were selected on each of the <code>ncomp</code> components.
Then, a <code><a href="mint.splsda.html">mint.splsda</a></code> can be performed with <code>keepX</code> set as the output <code>choice.keepX</code>.
</p>
<p>All component <i>1:\code{ncomp}</i> are tuned, except the first ones for which a <code>already.tested.X</code> is provided. See examples below.
</p>
<p>The function outputs the optimal number of components that achieve the best performance based on the overall error rate or BER. The assessment is data-driven and similar to the process detailed in (Rohart et al., 2016), where one-sided t-tests assess whether there is a gain in performance when adding a component to the model. Our experience has shown that in most case, the optimal number of components is the number of categories in <code>Y</code> - 1, but it is worth tuning a few extra components to check (see our website and case studies for more details).
</p>
<p>BER is appropriate in case of an unbalanced number of samples per class as it calculates the average proportion of wrongly classified samples in each class, weighted by the number of samples in each class. BER is less biased towards majority classes during the performance assessment.
</p>
<p>More details about the prediction distances in <code>?predict</code> and the supplemental material of the mixOmics article (Rohart et al. 2017).
</p>


<h3>Value</h3>

<p>The returned value is a list with components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>error.rate</code></td>
<td>
<p>returns the prediction error for each <code>test.keepX</code> on each component, averaged across all repeats and subsampling folds. Standard deviation is also output. All error rates are also available as a list.</p>
</td></tr>
<tr valign="top"><td><code>choice.keepX</code></td>
<td>
<p>returns the number of variables selected (optimal keepX) on each component.</p>
</td></tr>
<tr valign="top"><td><code>choice.ncomp</code></td>
<td>
<p>returns the optimal number of components for the model fitted with <code>$choice.keepX</code> </p>
</td></tr>
<tr valign="top"><td><code>error.rate.class</code></td>
<td>
<p>returns the error rate for each level of <code>Y</code> and for each component computed with the optimal keepX</p>
</td></tr>
<tr valign="top"><td><code>predict</code></td>
<td>
<p>Prediction values for each sample, each <code>test.keepX</code> and each comp.</p>
</td></tr>
<tr valign="top"><td><code>class</code></td>
<td>
<p>Predicted class for each sample, each <code>test.keepX</code> and each comp.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florian Rohart</p>


<h3>References</h3>

<p>Rohart F, Eslami A, Matigian, N, Bougeard S, Lê Cao K-A (2017). MINT: A multivariate integrative approach to identify a reproducible biomarker signature across multiple experiments and platforms. BMC Bioinformatics 18:128.
</p>
<p>mixOmics article:
</p>
<p>Rohart F, Gautier B, Singh A, Lê Cao K-A. mixOmics: an R package for 'omics feature selection and multiple data integration. PLoS Comput Biol 13(11): e1005752
</p>


<h3>See Also</h3>

<p><code><a href="mint.splsda.html">mint.splsda</a></code> and http://www.mixOmics.org for more details.</p>


<h3>Examples</h3>

<pre>
data(stemcells)
data = stemcells$gene
type.id = stemcells$celltype
exp = stemcells$study

res = mint.splsda(X=data,Y=type.id,ncomp=3,keepX=c(10,5,15),study=exp)
out = tune.mint.splsda(X=data,Y=type.id,ncomp=2,near.zero.var=FALSE,
study=exp,test.keepX=seq(1,10,1))

out$choice.ncomp
out$choice.keepX

## Not run: 

out = tune.mint.splsda(X=data,Y=type.id,ncomp=2,near.zero.var=FALSE,
study=exp,test.keepX=seq(1,10,1))
out$choice.keepX

## only tune component 2 and keeping 10 genes on comp1
out = tune.mint.splsda(X=data,Y=type.id,ncomp=2, study=exp,
already.tested.X = c(10),
test.keepX=seq(1,10,1))
out$choice.keepX


## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>mixOmics</em> version 6.6.2 <a href="00Index.html">Index</a>]</div>
</body></html>
