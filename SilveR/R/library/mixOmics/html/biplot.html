<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: biplot methods for 'pca' family</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for biplot {mixOmics}"><tr><td>biplot {mixOmics}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>biplot methods for <code>pca</code> family</h2>

<h3>Description</h3>

<p>biplot methods for <code>pca</code> family
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'pca'
biplot(
  x,
  comp = c(1, 2),
  block = NULL,
  ind.names = TRUE,
  group = NULL,
  cutoff = 0,
  col.per.group = NULL,
  col = NULL,
  ind.names.size = 3,
  ind.names.col = color.mixo(4),
  ind.names.repel = TRUE,
  pch = 19,
  pch.levels = NULL,
  pch.size = 2,
  var.names = TRUE,
  var.names.col = "grey40",
  var.names.size = 4,
  var.names.angle = FALSE,
  var.arrow.col = "grey40",
  var.arrow.size = 0.5,
  var.arrow.length = 0.2,
  ind.legend.title = NULL,
  vline = FALSE,
  hline = FALSE,
  legend = if (is.null(group)) FALSE else TRUE,
  legend.title = NULL,
  pch.legend.title = NULL,
  cex = 1.05,
  ...
)

## S3 method for class 'mixo_pls'
biplot(
  x,
  comp = c(1, 2),
  block = NULL,
  ind.names = TRUE,
  group = NULL,
  cutoff = 0,
  col.per.group = NULL,
  col = NULL,
  ind.names.size = 3,
  ind.names.col = color.mixo(4),
  ind.names.repel = TRUE,
  pch = 19,
  pch.levels = NULL,
  pch.size = 2,
  var.names = TRUE,
  var.names.col = "grey40",
  var.names.size = 4,
  var.names.angle = FALSE,
  var.arrow.col = "grey40",
  var.arrow.size = 0.5,
  var.arrow.length = 0.2,
  ind.legend.title = NULL,
  vline = FALSE,
  hline = FALSE,
  legend = if (is.null(group)) FALSE else TRUE,
  legend.title = NULL,
  pch.legend.title = NULL,
  cex = 1.05,
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>An object of class 'pca'or mixOmics '(s)pls'.</p>
</td></tr>
<tr valign="top"><td><code>comp</code></td>
<td>
<p>integer vector of length two (or three to 3d). The components
that will be used on the horizontal and the vertical axis respectively to
project the individuals.</p>
</td></tr>
<tr valign="top"><td><code>block</code></td>
<td>
<p>Character, name of the block to show for <code>pls</code> object.
Default to <code>'X'</code>.</p>
</td></tr>
<tr valign="top"><td><code>ind.names</code></td>
<td>
<p>either a character vector of names for the individuals to
be plotted, or <code>FALSE</code> for no names. If <code>TRUE</code>, the row names of
the first (or second) data matrix is used as names (see Details).</p>
</td></tr>
<tr valign="top"><td><code>group</code></td>
<td>
<p>Factor indicating the group membership for each sample.</p>
</td></tr>
<tr valign="top"><td><code>cutoff</code></td>
<td>
<p>numeric between 0 and 1. Variables with correlations below
this cutoff in absolute value are not plotted (see Details).</p>
</td></tr>
<tr valign="top"><td><code>col.per.group</code></td>
<td>
<p>character (or symbol) color to be used when 'group' is
defined. Vector of the same length as the number of groups.</p>
</td></tr>
<tr valign="top"><td><code>col</code></td>
<td>
<p>character (or symbol) color to be used, possibly vector.</p>
</td></tr>
<tr valign="top"><td><code>ind.names.size</code></td>
<td>
<p>Numeric, sample name size.</p>
</td></tr>
<tr valign="top"><td><code>ind.names.col</code></td>
<td>
<p>Character, sample name colour.</p>
</td></tr>
<tr valign="top"><td><code>ind.names.repel</code></td>
<td>
<p>Logical, whether to repel away label names.</p>
</td></tr>
<tr valign="top"><td><code>pch</code></td>
<td>
<p>plot character. A character string or a vector of single
characters or integers. See <code><a href="../../graphics/html/points.html">points</a></code> for all alternatives.</p>
</td></tr>
<tr valign="top"><td><code>pch.levels</code></td>
<td>
<p>If <code>pch</code> is a factor, a named vector providing the
point characters to use. See examples.</p>
</td></tr>
<tr valign="top"><td><code>pch.size</code></td>
<td>
<p>Numeric, sample point character size.</p>
</td></tr>
<tr valign="top"><td><code>var.names</code></td>
<td>
<p>Logical indicating whether to show variable names. 
Alternatively, a character.</p>
</td></tr>
<tr valign="top"><td><code>var.names.col</code></td>
<td>
<p>Character, variable name colour.</p>
</td></tr>
<tr valign="top"><td><code>var.names.size</code></td>
<td>
<p>Numeric, variable name size.</p>
</td></tr>
<tr valign="top"><td><code>var.names.angle</code></td>
<td>
<p>Logical, whether to align variable names to arrow
directions.</p>
</td></tr>
<tr valign="top"><td><code>var.arrow.col</code></td>
<td>
<p>Character, variable arrow colour. If 'NULL', no arrows
are shown.</p>
</td></tr>
<tr valign="top"><td><code>var.arrow.size</code></td>
<td>
<p>Numeric, variable arrow head size.</p>
</td></tr>
<tr valign="top"><td><code>var.arrow.length</code></td>
<td>
<p>Numeric, length of the arrow head in 'cm'.</p>
</td></tr>
<tr valign="top"><td><code>ind.legend.title</code></td>
<td>
<p>Character, title of the legend.</p>
</td></tr>
<tr valign="top"><td><code>vline</code></td>
<td>
<p>Logical, whether to draw the vertical neutral line.</p>
</td></tr>
<tr valign="top"><td><code>hline</code></td>
<td>
<p>Logical, whether to draw the horizontal neutral line.</p>
</td></tr>
<tr valign="top"><td><code>legend</code></td>
<td>
<p>Logical, whether to show the legend if <code>group != NULL</code>.</p>
</td></tr>
<tr valign="top"><td><code>legend.title</code></td>
<td>
<p>Character, the legend title if <code>group != NULL</code>.</p>
</td></tr>
<tr valign="top"><td><code>pch.legend.title</code></td>
<td>
<p>Character, the legend title if <code>pch</code> is a factor.</p>
</td></tr>
<tr valign="top"><td><code>cex</code></td>
<td>
<p>Numeric scalar indicating the desired magnification of plot texts.
<code><a href="../../ggplot2/help/theme.html">theme</a></code> function may be used with the output object if
further customisation is required.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Not currently used.</p>
</td></tr>
<tr valign="top"><td><code>pch.legend</code></td>
<td>
<p>Character, the legend title if <code>pch</code> is a factor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>biplot</code> unifies the reduced representation of both the
observations/samples and variables of a matrix of multivariate data on the
same plot. Essentially, in the reduced space the samples are shown as
points/names and the contributions of features to each dimension are shown as
directed arrows or vectors.
For <code>pls</code> objects it is possible to use either <code>'X'</code> or <code>'Y'</code>
latent space using <code>block</code> argument.
</p>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Al J Abadi
</p>


<h3>Examples</h3>

<pre>
data("nutrimouse")
## --------- pca ---------- ##
pca.lipid &lt;- pca(nutrimouse$lipid, ncomp = 3, scale = TRUE)
# seed for reproducible geom_text_repel
set.seed(42)
biplot(pca.lipid)
## correlation cutoff to filter features
biplot(pca.lipid, cutoff = c(0.8))
## tailor threshold for each component
biplot(pca.lipid, cutoff = c(0.8, 0.7))
## customise components
biplot(pca.lipid, cutoff = c(0.8), comp = c(1,3))

## customise ggplot in an arbitrary way
biplot(pca.lipid) + theme_linedraw() + 
    # add vline
    geom_vline(xintercept = 0, col = 'green') +
    # add hline
    geom_hline(yintercept = 0, col = 'green') +
    # customise labs
    labs(x = 'Principal Component 1', y = 'Principal Component 2')

## group samples
biplot(pca.lipid, group = nutrimouse$diet, legend.title = 'Diet')

## customise variable labels
biplot(pca.lipid, 
       var.names.col = color.mixo(2),
       var.names.size = 4,
       var.names.angle = TRUE
)

## no arrows
biplot(pca.lipid, group = nutrimouse$diet, legend.title = 'Diet', 
       var.arrow.col = NULL, var.names.col = 'black')

## add x=0 and y=0 lines in function
biplot(pca.lipid, group = nutrimouse$diet, legend.title = 'Diet', 
       var.arrow.col = NULL, var.names.col = 'black', 
       vline = TRUE, hline = TRUE)

## --------- spca
## example with spca
spca.lipid &lt;- spca(nutrimouse$lipid, ncomp = 2, scale = TRUE, keepX = c(8, 6))
biplot(spca.lipid, var.names.col = 'black', group = nutrimouse$diet, 
       legend.title = 'Diet')

## --------- pls ---------- ##
data("nutrimouse")
pls.nutrimouse &lt;- pls(X = nutrimouse$gene, Y = nutrimouse$lipid, ncomp = 2)
biplot(pls.nutrimouse, group = nutrimouse$genotype, block = 'X',
       legend.title = 'Genotype', cutoff = 0.878) 

biplot(pls.nutrimouse, group = nutrimouse$genotype, block = 'Y',
       legend.title = 'Genotype', cutoff = 0.8) 

## --------- plsda ---------- ##
data(breast.tumors)
X &lt;- breast.tumors$gene.exp
colnames(X) &lt;- paste0('GENE_', colnames(X))
rownames(X) &lt;- paste0('SAMPLE_', rownames(X))
Y &lt;- breast.tumors$sample$treatment

plsda.breast &lt;- plsda(X, Y, ncomp = 2)
biplot(plsda.breast, cutoff = 0.72)
## remove arrows
biplot(plsda.breast, cutoff = 0.72, var.arrow.col = NULL, var.names.size = 4)
</pre>

<hr /><div style="text-align: center;">[Package <em>mixOmics</em> version 6.18.1 <a href="00Index.html">Index</a>]</div>
</div></body></html>
