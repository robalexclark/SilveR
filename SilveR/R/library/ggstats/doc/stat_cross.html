<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Compute cross-tabulation statistics with stat_cross()</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Compute cross-tabulation statistics with
<code>stat_cross()</code></h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggstats)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>This statistic is intended to be used with two discrete variables
mapped to <strong>x</strong> and <strong>y</strong> aesthetics. It will
compute several statistics of a cross-tabulated table using
<code>broom::tidy.test()</code> and <code>stats::chisq.test()</code>.
More precisely, the computed variables are:</p>
<ul>
<li><strong>observed</strong>: number of observations in x,y</li>
<li><strong>prop</strong>: proportion of total</li>
<li><strong>row.prop</strong>: row proportion</li>
<li><strong>col.prop</strong>: column proportion</li>
<li><strong>expected</strong>: expected count under the null
hypothesis</li>
<li><strong>resid</strong>: Pearsonâ€™s residual</li>
<li><strong>std.resid</strong>: standardized residual</li>
<li><strong>row.observed</strong>: total number of observations within
row</li>
<li><strong>col.observed</strong>: total number of observations within
column</li>
<li><strong>total.observed</strong>: total number of observations within
the table</li>
<li><strong>phi</strong>: phi coefficients, see
<code>augment_chisq_add_phi()</code></li>
</ul>
<p>By default, <code>stat_cross()</code> is using
<code>ggplot2::geom_points()</code>. If you want to plot the number of
observations, you need to map <code>after_stat(observed)</code> to an
aesthetic (here <strong>size</strong>):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(Titanic)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Class, <span class="at">y =</span> Survived, <span class="at">weight =</span> Freq, <span class="at">size =</span> <span class="fu">after_stat</span>(observed)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="fu">stat_cross</span>() <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA6lBMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6AGY6OmY6OpA6kNtNTU1NTW5NTY5Nbo5NbqtNjshmAABmADpmAGZmOgBmOpBmtv9uTU1uTW5uTY5ubo5ubqtujshuq+SOTU2OTW6OTY6Obk2ObquOoo6Oq6uOtauOyMiOyP+QOgCQOjqQOmaQZgCQ27aQ29uQ2/+rbk2rbm6rjk2rq46ryKur5P+2ZgC2///Ijk3Ijm7IyI7I5KvI/8jI///bkDrb/7bb///kq27k///r6+v/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T////x/Ox7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMVUlEQVR4nO3de2PbthEAcCZZ3a1W0trtpjTL0jltN6d72FkT2dtqLbZk1Q/x+3+d4cCnRAAHgAAJgHd/mA7CgOQv4AsEj1keU6zkkXVCMbPBIjNvG+MjDHiURAaLTANI7CMXMlgkASGRBJDMRypksMgUgOQ+MiGDRSYApPIZC2hvcZK1EBfrze4KSCxEQAREQNpAiI9QqKpvc5Bl8zy/P86efaon0wISN6Gyuvuvz/LN52eP7+b58jd5OSGgpvY1cCzm999c5JvfXpQTAtqtnbWizRefWpOJAamPQTnbrw7z9TMuU04IqF37/fEhO1Sn3YL6nOY3B3NQSvsY1AOo8OG7GT+LHSZ5FusBtORzzBO/Dgrybj4WIPEhenJA8g7F0TrMAgMKr8s1DiBpA5oekEhoNeZjH4stNpzdEKhLJG8+0trTBuoKKWKSQDXRCuOZLBAEjiOvfRJAekFASBAQEgSEBAEhQUBIEBASBIQEASFBQEgQEBITBkJv5BW1pw5E3R1m/UHUYbYTRn32EwQS99pTp72aR040MSCFDw3iJCAcSOmDDsFLHwjxEQoREAHp+4iEJgSk49MVIiCkCRFQSEDivdwUaH9D0gBC1kIKkYnKdqsZBmidZU8v/L3tg6xHd3OEM4s3RxNIz6cjVFYHw8ab13ycv+2D/U/tb454bsl/uEugbhNqVdkMsXc80h5Zk+6aCWeWbtBgQKzNeHlXQ70q3XUTzyzfIpdA0l0MXkZ4cubnbR8VkMhMa0uGB/L2vphibYRHXUOfTLJaHSAHp3kvbxwabq25j0TIMVC5U3l428dig01jCCB43YcdgzxcB3nGgXAHNMbNqnceAkJDE0ijv8xTf9D2/Ij9vDwKHWi8HsW7bz/md6+uYgcSvrPhBAhaz+WbPH/4bvaCMd3O+CQ8IOSpj8enGg9//vD6Jgek66P84eQKJiw+YxEU0HjPxa5np8D0EXRg0vpXsQBJXopyBMSPQGwPm82es8PRS/gZJJDinVW/z+YLoJP6yHP71U2YQNLOAtnsLoHgGMRkACdgIFFvk//xQQUQ28dg37oM9ixWEe316I46wmwkH40xiqu6w0U164hANj0b+kJKoJYSFt6BVLkORKXGbCtbIL3wD6TqchWVGQpJfOIHWpn1SffvtA8XSJ3rYJ9HTCR/6pMCEJLrYJ9HNL+YuXBOAcjNo2dR85FuQmRASK4DzcELguaTDlC1geK1kK3dfkEN06oqISA3A6j2GxYBIcUEhBQTEFJMQEgxASHFtkCiCzLBsiYJpL5s1ag9bSDRPYs0pgckuqdTEE0OSOIjFbIBuj+ua326PwwtcCApj/wuyAIIYlkMO5+j/yooIKWP0zcOS5p1XC0I8XE5/CVKINTH5Qt15S52iP6rqQLB2y/8YzfxAGn4jP2+2KhAWj7KdzUIyCnQku1gy+5g6mCBNH26zxMsgRbP/nc8f3zXGY5PQEWw0zyc6eM5zev77L/rR0DqJmQJlC9hF4voOmhwoOI6CPeZLpBupAMErzon+/EjE59MUvuS3Thovxauc/SJFCiTAG1+9/u5wQfY4HtbGndi6QA9/vRP1myMXupdFC8ppgYk2cWWh7Bfmb4WvojlOqg3EGszjxYtCPcJBKj3Waz4hN+h/jFIb/9KBygvTvPar4XrdNenCJTsddCwN6v8TrWoLpaD9OB38/oRCNDgHWapAnVejbIEiu1Ww0DIDVBstxq6QMr8QUZAeVy3GppCznN3RHOroS3kEiiqWw0tIJfJTWK71dARcpm7I7pbDQ0hp7k7+H1JfECqjHNuR5hF2oLkRM4/p67zWD5IIPmbi5Jl2QFFd7PajqyTeYHGSe9F02xKInlME4gHaqOoHQWKehczCkugkqnTsU9Au7HGz2UWW2w4e9BAtIupgRbUgiRA5UE6qv4gu7AE0g+LLTacnYCQ4hCBlmzfgr0sniF41mEFtGY+MEY6okGc1mEDBI/u883BXOue3mKLDWcPD4h3BkErousgBRBvPAQkBCoGysDwmOEvFNvdOMpNQLZbUI9kFSyAoPXwQ9Ba4+GqloQekKAn0A5IWI1LIHjoc8gakc6DH1dAsr5kcyBJNU6BDMIRkMQnM86jKK0mNqDddZf7GCa7VUDHBKTy0BQy5JEShQhkxuPwuxpxAJnyOP34UQRA5j6TArLg0QXSqytwICsfPSDdykIGsuMhICdA+rWFC2TrowNkUl2oQNY+yQPZy2gDmdUXFFBvnZSABMt34YMDmVY4DpBgBZzwJAIkWgVHPkkAidbBCQ4EBmRa386I12GARGtBQM2KOqMQh2sg4ScF4P2vpxeeXup1TrIbgwAt+AMc7eQmRkDuSXZjCKDHn/gTHA/fm08EiI8YM0xNsRd3L0/zvPtFY/8+gwBtPj+DVmSa3GQXCL78mAKQ9Cy2mPdqQa/+c1QAlZ98ThGozzGI0VyecqDic6t58a3nAb6TOQQQ7FSPf7vQTm4iBnr4/gZ+nlzlzfeeA2hBTm41lsWY3h7XQdB2rt+wn/DL9n1qQBqhAbR9/yH+FrTyCFScyupjULmifliaQIHC6DArTvDXLzpnsciApHkU+wJJwuYYYBg4UOid9r5kynAKNE6CJdGKDNcfZCLkKn+QIdC4PYpmQuMAjdsnrb8wp/mDjIBGfaqhvTDn+YNMgEZ8LmYgNCrQarQnq3qLEmZgGBvIhZEmEDrINfRBnP6BVItwnB4nUiDFQPsYBpIPASReiPv0OF6AbIWMgEQXrfG8zDIIEF9Mk/wliys9ziBAO8tBZgwNyONIe7sIDsiCaGpA+znGkFhND2jvKKrWkvgkDrTq3PxLeUxfyUwGqFPe3fHK/H4EVEWFktUdkopN6MfSWoWIgCB2dzzFJlh6dFchMiBBMQEhxQSEFBMQUkxASDEBIcUEhBQTEFJMQEgxASHFdkDdK3LJsqYI1O0UkMf0gGQdJ7JVmBqQvOeNgFQ8UqJpASl9YslA5Q8I4RELTQgI9xERTQdIyyfs/EFegTR9Qs4f5BVI2yfA9DgEFACQgU9g+YOGATLyGSs9DgGFC2ToI0xNkTKQsU9biIAIiICQ5Vr4oEMjCIiACIiANIHsfDJ17QTUAXp81ze5SVJAWQdoMYcUOR6SvO3GZ0bFprO3wzEQpFTKvSR509q08IE2X/wddrE+Kbq0Il6gA54Cr0+SN62IBahzkN5tOv5a0HDhGOj+D5zE+zFouHAMBGcx1m76JHkLLFY9hfaB2JUPfNDR/XXQWOEaSCMICIl+QK0cptWvdy9ns9P2PNvz8o+3s1YWNF7MSmZ14jid6AW0Gh7otrXFJRCkErz79mNrpgqIp2Q8ahdD7rj80kRo1U9oaKDL5x9AhbeMKkneLRBcnt69/hdvSKz4y7dNg4KMlX98y+f+8u1feVpGBlUVvbgCTOC9lahFBlRmwT3hLaO1t7FWdPeySLsI2RdbexzMBwmYefEPlUJVxP72mv1k87OJMPoArUYDKvJzNkDb8zf8T2UG2PoYxCCef6xNt+c/HO3VworvXt/8++ejJifqXqzshYZN+l9FmahzVm44j4fv3uQVEC+8bFoQtK3ib1jxX17fNLWwPWzGqnk4+eXkv69+ObkSLCyP6MlqFZUK25uas1iVw7zTgnJ+dKpbUHMMKov4DD/+afv+56NcHPZAvnK5IgGbBoeaBqjwqYDaxyCYr2xBZXF1FquLoKZZcRTSADJLVLAaDSi/5Nc323N+FrueQZxWQNvz5ix2Pat3xbK4vA7iRWwfY39bnMNeSPaweMYHjRW2QIOnKh0rVnZCw6cqHSv2gTRHAQ8/ynWs6ACFOk56rOgC4W8ijDLSfqwQAWGJdkT/xGCRnoDgu1TwzBI+DuMwhEAKodESTSLx+A66LpfwXaEhgBSJiCTzGyzSC9Ci6NpdPvs0EJAwO7ro6BwG0P3xvPoVgDYHbFUP82I6b6YWIQVatRMR1X+QhsEifQC1mg37lXMtn17w0s3BvJra1KwC2mlIyHwGi/QC1Dx9Yxq/fiqmVWn32Zx+YEC6YbBI/y0oz9fFKW2RZfyxXDW1iESAqmMQPO+GXQwGUHCz8jldPTWORIDg9MUn/MADgyby9ZOiUdV2x16OQbEA7VwHgc3m4MnZGhoN/Lmc2lScChA/ztRX0uz3J/9gLaY8FNVTi0gHyFMQUHhBQEgQEBIEhAQBIUFASBAQEgSEBAEh8X9wWpkL63nPCgAAAABJRU5ErkJggg==" /><!-- --></p>
<p>Note that the <strong>weight</strong> aesthetic is taken into account
by <code>stat_cross()</code>.</p>
<p>We can go further using a custom shape and filling points with
standardized residual to identify visually cells who are over- or
underrepresented.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">x =</span> Class, <span class="at">y =</span> Survived, <span class="at">weight =</span> Freq,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">after_stat</span>(observed), <span class="at">fill =</span> <span class="fu">after_stat</span>(std.resid)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="fu">stat_cross</span>(<span class="at">shape =</span> <span class="dv">22</span>) <span class="sc">+</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="fu">scale_fill_steps2</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">show.limits =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>We can easily recreate a cross-tabulated table.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Class, <span class="at">y =</span> Survived, <span class="at">weight =</span> Freq) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">&quot;cross&quot;</span>, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(observed))) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Even more complicated, we want to produce a table showing column
proportions and where cells are filled with standardized residuals. Note
that <code>stat_cross()</code> could be used with facets. In that case,
computation is done separately in each facet.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">x =</span> Class, <span class="at">y =</span> Survived, <span class="at">weight =</span> Freq,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">after_stat</span>(col.prop), <span class="at">accuracy =</span> .<span class="dv">1</span>),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">after_stat</span>(std.resid)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="fu">stat_cross</span>(<span class="at">shape =</span> <span class="dv">22</span>, <span class="at">size =</span> <span class="dv">30</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">&quot;cross&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="fu">scale_fill_steps2</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">show.limits =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(Sex)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Standardized residuals&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
